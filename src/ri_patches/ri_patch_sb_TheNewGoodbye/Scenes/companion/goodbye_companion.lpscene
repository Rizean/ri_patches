WHAT: all
WHERE: all
WHEN: 23-6
WHO: Companion = getCompanionAny()
OTHER: none

    SceneStart()
    
    DebugLog = false
    
    If Player.isNaked()
        Player.dress()
    Endif
    If CurrentCompanion.isNaked()
        CurrentCompanion.dress()
    Endif
    
    If !CurrentCompanion.isProstitute()
        PCustomersToday = 0
        PMoneyToday = 0
        CustomersToday.clearGlobal()
        MoneyToday.clearGlobal()
    Endif
    
    CurrentCompanion.show(2)
    
    CurrentCompanionID = CurrentCompanion.getID()
    BNurseProstitute = NurseProstitute.getGlobal()
    BNurseProstituteSon = NurseProstituteSon.getGlobal()
    BNurseLostProstitute = NurseLostProstitute.getGlobal()
    
    If CurrentCompanion.isCreature()
        "Time flies. I have enjoyed taking <CurrentCompanion.name> out for a walk but it's time to head home."
        endDate()
    Elseif BNurseProstituteSon  == CurrentCompanionID
        "Time flies. I have enjoyed spending time with <CurrentCompanion.name> but it's time to part."
        "It has been good catching up with <CurrentCompanion.name>."
        endDate()
    Elseif BNurseLostProstitute == CurrentCompanionID && BNurseLostProstitute != 1
        "Should I offer to walk <CurrentCompanion.name> home?"
        0:: "Yes"
        1:: "No"
        
        If 0
            CurrentCompanion(Surprised)::"No, thank you. If Trey would catch us together at home, he would probably kill you. I'm happy to walk home myself."
            "I couldn't really insist on it, so we waved goodbye and went our separate ways."
            endDate()
        Else
            Player(Happy):: "Goodbye. I had a great time today. See you soon!"
            "We went our separate ways."
            endDate()
        Endif
    Else
        FollowUpScene = false
        WalkedHome = false
        ForcedtoWalkHome = false
        ForcedtoStay = false
        MyHome = false
        Payed = false
        Kissed = false
        LickNTR = false
        HadAShower = false
        TryedKissing = false
        RelationTalk = false
        StepFail = false
        ManipulateFail = false
        TrainedStrip = false
        TrainedLapdance = false
        WearsCollar = false
        MasturbatedForYou = false
        GaveSpanking = false
        Dating = CurrentCompanion.IsDating()
        HadAlreadySexBeforeCatch.clearGlobal()
        
        XForcedTrigger = CurrentCompanion.getActorVar(ForcedTrigger)
        XBPisPregnant = CurrentCompanion.getActorVar(BPisPregnant)
        
        // Count your relationships
        Actor = getSpecific(Dating)
        NumberOfGirlfriends = 0
        While Actor.isValid() && NumberOfGirlfriends < 25
            NumberOfGirlfriends += 1
            If Actor:masochist < -75 && Actor:attractiontoplayer > 35
                JealousGirl = Actor
            Endif
            If NumberOfGirlfriends == 1
                ID = Actor.getID()
                Player.setActorVar(Dating1, ID)
                Girlfriend1 = Actor
            Elseif NumberOfGirlfriends == 2
                ID = Actor.getID()
                Player.setActorVar(Dating2, ID)
                Girlfriend2 = Actor
            Elseif NumberOfGirlfriends == 3
                ID = Actor.getID()
                Player.setActorVar(Dating3, ID)
                Girlfriend3 = Actor
            Elseif NumberOfGirlfriends == 4
                ID = Actor.getID()
                Player.setActorVar(Dating4, ID)
                Girlfriend4 = Actor
            Elseif NumberOfGirlfriends == 5
                ID = Actor.getID()
                Player.setActorVar(Dating5, ID)
                Girlfriend5 = Actor
            Elseif NumberOfGirlfriends == 6
                ID = Actor.getID()
                Player.setActorVar(Dating6, ID)
                Girlfriend6 = Actor
            Elseif NumberOfGirlfriends == 7
                ID = Actor.getID()
                Player.setActorVar(Dating7, ID)
                Girlfriend7 = Actor
            Elseif NumberOfGirlfriends == 8
                ID = Actor.getID()
                Player.setActorVar(Dating8, ID)
                Girlfriend8 = Actor
            Elseif NumberOfGirlfriends == 9
                ID = Actor.getID()
                Player.setActorVar(Dating9, ID)
                Girlfriend9 = Actor
            Elseif NumberOfGirlfriends == 10
                ID = Actor.getID()
                Player.setActorVar(Dating10, ID)
                Girlfriend10 = Actor
            Elseif NumberOfGirlfriends == 11
                ID = Actor.getID()
                Player.setActorVar(Dating11, ID)
                Girlfriend11 = Actor
            Elseif NumberOfGirlfriends == 12
                ID = Actor.getID()
                Player.setActorVar(Dating12, ID)
                Girlfriend12 = Actor
            Elseif NumberOfGirlfriends == 13
                ID = Actor.getID()
                Player.setActorVar(Dating13, ID)
                Girlfriend13 = Actor
            Elseif NumberOfGirlfriends == 14
                ID = Actor.getID()
                Player.setActorVar(Dating14, ID)
                Girlfriend14 = Actor
            Elseif NumberOfGirlfriends == 15
                ID = Actor.getID()
                Player.setActorVar(Dating15, ID)
                Girlfriend15 = Actor
            Elseif NumberOfGirlfriends == 16
                ID = Actor.getID()
                Player.setActorVar(Dating16, ID)
                Girlfriend16 = Actor
            Elseif NumberOfGirlfriends == 17
                ID = Actor.getID()
                Player.setActorVar(Dating17, ID)
                Girlfriend17 = Actor
            Elseif NumberOfGirlfriends == 18
                ID = Actor.getID()
                Player.setActorVar(Dating18, ID)
                Girlfriend18 = Actor
            Elseif NumberOfGirlfriends == 19
                ID = Actor.getID()
                Player.setActorVar(Dating19, ID)
                Girlfriend19 = Actor
            Elseif NumberOfGirlfriends == 20
                ID = Actor.getID()
                Player.setActorVar(Dating20, ID)
                Girlfriend20 = Actor
            Endif
            If isPlayerMarried()
                Actor.setActorVar(tag_Girlfriend, 0)
                Actor.setActorVar(tag_Wife, 1)
            Else
                Actor.setActorVar(tag_Girlfriend, 1)
                Actor.setActorVar(tag_Wife, 0)
            Endif
            Actor = getSpecific(Dating)
        endWhile
        If CurrentCompanion.isDating()
            NumberOfGirlfriends += 1
        Endif
        Player.setActorVar(TNG_DatingCount, NumberOfGirlfriends)
        
        If XForcedTrigger > 100
            FollowUpScene = true
            CurrentCompanion.setActorVar(ForcedTrigger, 0)
            MyHome = false
        Elseif XForcedTrigger > 0
            FollowUpScene = true
            CurrentCompanion.setActorVar(ForcedTrigger, 0)
            MyHome = true
        Elseif Dating && isPlayerMarried()
            "Time flies. I have enjoyed spending time with <CurrentCompanion.name>."
            "After our date, my <CurrentCompanion.husband_or_wife> and I headed home together."
            MyHome = true
            WalkedHome = true
        Elseif Dating && [!PlayerHasHome() || !DatingHasHome()]
            "Time flies. I have enjoyed spending time with <CurrentCompanion.name>."
            "After our date, my <CurrentCompanion.boyfriend_or_girlfriend> and I headed home together."
            MyHome = true
            WalkedHome = true
        Elseif Dating && CurrentCompanion.isExRelative() && !isPlayerMarried() && CurrentCompanion.livesWithPlayer()
            "Time flies. I have enjoyed spending time with my <CurrentCompanion.relationship> now also my <CurrentCompanion.boyfriend_or_girlfriend>."
            "After our date, my <CurrentCompanion.relationship> and I headed home together."
            MyHome = true
            WalkedHome = true
        Elseif Dating && CurrentCompanion.isExRelative() && !isPlayerMarried() && !CurrentCompanion.livesWithPlayer()
            "Time flies. I have enjoyed spending time with my <CurrentCompanion.relationship> now also my <CurrentCompanion.boyfriend_or_girlfriend>."
            "After our date, my <CurrentCompanion.relationship> and I headed home together."
            WalkedHome = true
        Elseif CurrentCompanion.isRelative() && !isModEnabled(vin_Incest) && !CurrentCompanion.livesWithPlayer()
            "Time flies. I have enjoyed spending time with <CurrentCompanion.name> but it's time to part."
            "It has been good catching up with my <CurrentCompanion.relationship>."
            endDate()
        Elseif CurrentCompanion.isRelative() && !isModEnabled(vin_Incest) && CurrentCompanion.livesWithPlayer()
            "Time flies. I have enjoyed spending time with <CurrentCompanion.name> but it's time."
            "After our date, my <CurrentCompanion.relationship> and I headed home together."
            endDate()
        Elseif CurrentCompanion.isRelative() && isModEnabled(vin_Incest) && CurrentCompanion.livesWithPlayer()
            "Time flies. I have enjoyed spending time with <CurrentCompanion.name> but it's time."
            "After our date, my <CurrentCompanion.relationship> and I headed home together."
            MyHome = true
            WalkedHome = true
        Elseif !CurrentCompanion.isRelative() && CurrentCompanion.IsDominantSex(Player) && CurrentCompanion.isMale()
            If  !isAtHome() && [Dating || CurrentCompanion:interpersonal + CurrentCompanion:attractiontoplayer > Random(0, 100)]
                CurrentCompanion::"I'll be glad to walk you home safe. It's only my duty."
                0:: "Be walked home"
                1:: "Decline"
            
                If 0
                    "How can I decline such a nice offer? <CurrentCompanion.name> walked me back to my apartment."
                    setBackground(streets)
                    passTime(0.1, 0.5)
                    moveTo(Home)
                    "A while later ..."
                    CurrentCompanion(Happy)::"Here we are. I'll see you later then."
                    0:: "Invite <CurrentCompanion.him_or_her> inside"
                    1:: "Say goodbye"
                    
                    If 0
                        WalkedHome = true
                        MyHome = true
                        If Dating
                            Player(Flirty):: "Baby, why don't you stay for the night?"
                            CurrentCompanion(Flirty):: "Of course, love."                
                        Else
                            Player(Flirty):: "Wait ... Do you want to come inside and chill for a while? You were so kind in walking me all the way back after all."
                            CurrentCompanion(Happy):: "Of course, it'll be my pleasure."
                        Endif
                    Else
                        Player(Happy):: "Goodbye. I had a great time today. See you soon!"
                        "We went our separate ways."
                        endDate()
                    Endif
                Else
                    Player(Surprised)::"It's not neccessary! Thank you for the nice offer though."
                    "We went our separate ways."
                    endDate()
                Endif 
            Else
                Player(Happy):: "Goodbye. I had a great time today. See you soon!"
                "We went our separate ways."
                endDate()
            Endif
        Elseif !CurrentCompanion.isRelative() && CurrentCompanion.IsDominantSex(Player) && !CurrentCompanion.isMale()
            If [CurrentCompanion:masochist < -55 || masochist > 55] && CurrentCompanion:masochist < masochist && CurrentCompanion.isProstitute() && isModEnabled(sb_PimpYourGirl)
                CurrentCompanion(Happy):: "Can you walk me home please? I don't want to go alone and want to make sure I'm safe."
                choice = 0
                ForcedtoWalkHome = true
            Else
                "Should I offer to walk <CurrentCompanion.name> home?"
                0:: "Yes"
                1:: "No"
                
            Endif
            
            If 0
                If !ForcedtoWalkHome
                   Player(Happy)::"Do you want me to walk you home? I just want to make sure you're safe."
                Endif
                If Dating || ForcedtoWalkHome || CurrentCompanion:attractiontoplayer > Random(0, 100) || CurrentCompanion:rapportwithplayer > Random(0, 100)
                    If !ForcedtoWalkHome
                        CurrentCompanion(Happy)::"Oh, thank you! That's very nice of you."
                    Endif
                    "I chivalrously walked with <CurrentCompanion.name> back to <CurrentCompanion.his_or_her> place."
                    If CurrentCompanion.IsDating()
                        MoveTo(Home_Dating)
                    Endif
                    setBackground(streets)
                    passTime(0.1, 0.5)
                    "A while later ..."
                    Player:: "So here it is, we arrived. I guess I'll see you soon ..."
                    If [CurrentCompanion:masochist < -75 || masochist > 75] && CurrentCompanion:masochist < masochist && CurrentCompanion.isProstitute() && isModEnabled(sb_PimpYourGirl)
                        If Dating
                            CurrentCompanion(Flirty)::"Listen baby, don't leave just yet. I want you to stay with me."
                            ForcedtoStay = true
                            WalkedHome = true
                        Else
                            CurrentCompanion(Flirty)::"Wait, don't leave just yet."
                            CurrentCompanion(Flirty)::"You need to come in for a minute."
                            ForcedtoStay = true
                            WalkedHome = true
                        Endif
                    Elseif Dating || CurrentCompanion:attractiontoplayer > Random(0, 100)
                        If Dating
                            CurrentCompanion(Flirty)::"Baby, don't leave just yet. Do you want to stay the night?"  
                        Else
                            CurrentCompanion(Flirty)::"Wait, don't leave just yet."
                            CurrentCompanion(Flirty)::"I feel guilty making you walk all the way here. Do you want to come in for tea or something?"                
                        Endif
                        0:: "Yes"
                        1:: "No"
                        
                        If 0
                            If Dating
                                Player(Happy):: "Of course, love."
                            Else
                                Player(Happy):: "Of course, I don't mind staying for a while."
                            Endif
                            CurrentCompanion(Excited):: "Excellent! Hang on a minute. Let me just open the door."
                            WalkedHome = true
                        Else
                            CurrentCompanion:attractiontoplayer *= 1.05
                            Player(Happy):: "That's okay. I'd better get going. See you!"
                            "We went our separate ways."
                            endDate()
                        Endif
                    Else
                        endDate()
                    Endif
                Else
                    CurrentCompanion(Surprised)::"No, thank you. I wouldn't want to bother you. I'm happy to walk home myself."
                    "I couldn't really insist on it, so we waved goodbye and went our separate ways."
                    endDate()
                Endif
            Else
                "I decided not to offer to walk <CurrentCompanion.him_or_her> back. We said goodbye and parted ways."
                endDate()
            Endif
        Elseif CurrentCompanion.isRelative() && CurrentCompanion.IsDominantSex(Player) && CurrentCompanion.isMale()
            If  !isAtHome() && [Dating || CurrentCompanion:interpersonal + CurrentCompanion:incest > Random(0, 100)  || CurrentCompanion:interpersonal + CurrentCompanion:attractiontoplayer > Random(0, 100)]
                CurrentCompanion::"I'll be glad to walk you home safe."
                0:: "Be walked home"
                1:: "Decline"
            
                If 0
                    "How can I decline such a nice offer? My <CurrentCompanion.relationship> walked me back to my apartment."
                    setBackground(streets)
                    passTime(0.1, 0.5)
                    moveTo(Home)
                    "A while later ..."
                    CurrentCompanion(Happy)::"Here we are. I'll see you later then."
                    0:: "Invite <CurrentCompanion.him_or_her> inside"
                    1:: "Say goodbye"
                    
                    If 0
                        WalkedHome = true
                        MyHome = true
                        If Dating
                            Player(Flirty):: "Baby, why don't you stay for the night?"
                            CurrentCompanion(Flirty):: "Of course, love."                
                        Else
                            Player(Flirty):: "Wait ... Do you want to come inside and chill for a while? You were so kind in walking me all the way back after all."
                            CurrentCompanion(Happy):: "Of course, <CurrentCompanion.Relationship>."
                        Endif
                    Else
                        Player(Happy):: "Goodbye. I had a great time today. See you soon!"
                        "We went our separate ways."
                        endDate()
                    Endif
                Else
                    Player(Surprised)::"It's not neccessary! Thank you for the nice offer though."
                    "We went our separate ways."
                    endDate()
                Endif
            Else
                Player(Happy):: "Goodbye. I had a great time today. See you soon!"
                "We went our separate ways."
                endDate()
            Endif
        Elseif CurrentCompanion.isRelative() && CurrentCompanion.IsDominantSex(Player) && !CurrentCompanion.isMale()
            "Should I offer to walk my <CurrentCompanion.relationship> home?"
            0:: "Yes"
            1:: "No"
            
            If 0
                Player(Happy)::"Do you want me to walk you home? I just want to make sure you're safe."
                If Dating || CurrentCompanion:attractiontoplayer > Random(0, 100) || CurrentCompanion:incest > Random(0, 100) || CurrentCompanion:rapportwithplayer > Random(0, 100)
                    CurrentCompanion(Happy)::"Oh, thank you! That's very nice of you."
                    "I chivalrously walked with my <CurrentCompanion.relationship> back to <CurrentCompanion.his_or_her> place."
                    If CurrentCompanion.IsDating()
                        MoveTo(Home_Dating)
                    Endif
                    setBackground(streets)
                    passTime(0.1, 0.5)
                    "A while later ..."
                    Player:: "So here it is, we arrived. I guess I'll see you soon ..."
                    If Dating || CurrentCompanion:incest > Random(0, 100) || CurrentCompanion:attractiontoplayer > Random(0, 100)
                        If Dating
                            CurrentCompanion(Flirty)::"Hey, don't leave just yet. Do you want to stay the night?"  
                        Else
                            CurrentCompanion(Flirty)::"Wait, don't leave just yet."
                            CurrentCompanion(Flirty)::"I feel guilty making you walk all the way here. Do you want to come in for tea or something?"                
                        Endif
                        0:: "Yes"
                        1:: "No"
                        
                        If 0
                            If Dating
                                Player(Happy):: "Of course, love."
                            Else
                                Player(Happy):: "Of course, <CurrentCompanion.Relationship>."
                            Endif
                            CurrentCompanion(Excited):: "Excellent! Hang on a minute. Let me just open the door."
                            WalkedHome = true
                        Else
                            CurrentCompanion:attractiontoplayer *= 1.05
                            CurrentCompanion:incest *= 1.05
                            Player(Happy):: "That's okay. I'd better get going. See you!"
                            "We went our separate ways."
                            endDate()
                        Endif
                    Else
                        endDate()
                    Endif
                Else
                    CurrentCompanion(Surprised)::"No, thank you. I wouldn't want to bother you. I'm happy to walk home myself."
                    "I couldn't really insist on it, so we waved goodbye and went our separate ways."
                    endDate()
                Endif
            Else
                "I decided not to offer to walk <CurrentCompanion.him_or_her> back. We said goodbye and parted ways."
                endDate()
            Endif
        Elseif CurrentCompanion.isRelative()
            "Should I offer to walk my <CurrentCompanion.relationship> home?"
            0:: "Yes"
            1:: "No"
            
            If 0
                Player(Happy)::"Do you want me to walk you home? I just want to make sure you're safe."
                If Dating || CurrentCompanion:attractiontoplayer > Random(0, 100) || CurrentCompanion:incest > Random(0, 100) || CurrentCompanion:rapportwithplayer > Random(0, 100)
                    CurrentCompanion(Happy)::"Oh, thank you! That's very nice of you."
                    "I walked with my <CurrentCompanion.relationship> back to <CurrentCompanion.his_or_her> place."
                    If CurrentCompanion.IsDating()
                        MoveTo(Home_Dating)
                    Endif
                    setBackground(streets)
                    passTime(0.1, 0.5)
                    "A while later ..."
                    Player:: "So here it is, we arrived. I guess I'll see you soon ..."
                    If Dating || CurrentCompanion:incest > Random(0, 100) || CurrentCompanion:attractiontoplayer > Random(0, 100)
                        If Dating
                            CurrentCompanion(Flirty)::"Baby, don't leave just yet. Do you want to stay the night?"  
                        Else
                            CurrentCompanion(Flirty)::"Wait, don't leave just yet."
                            CurrentCompanion(Flirty)::"I feel guilty making you walk all the way here. Do you want to come in for tea or something?"                
                        Endif
                        0:: "Yes"
                        1:: "No"
                        
                        If 0
                            If Dating
                                Player(Happy):: "Of course, love."
                            Else
                                Player(Happy):: "Of course, <CurrentCompanion.relationship>."
                            Endif
                            CurrentCompanion(Excited):: "Excellent! Hang on a minute. Let me just open the door."
                            WalkedHome = true
                        Else
                            CurrentCompanion:attractiontoplayer *= 1.05
                            CurrentCompanion:incest *= 1.05
                            Player(Happy):: "That's okay. I'd better get going. See you!"
                            "We went our separate ways."
                            endDate()
                        Endif
                    Else
                        endDate()
                    Endif
                Else
                    CurrentCompanion(Surprised)::"No, thank you. I wouldn't want to bother you. I'm happy to walk home myself."
                    "I couldn't really insist on it, so we waved goodbye and went our separate ways."
                Endif
            Else
                "I decided not to offer to walk my <CurrentCompanion.relationship> back. We said goodbye and parted ways."
                endDate()
            Endif
        Else
            If [CurrentCompanion:masochist < -55 || masochist > 55] && CurrentCompanion:masochist < masochist && CurrentCompanion.isProstitute() && isModEnabled(sb_PimpYourGirl)
                CurrentCompanion(Happy):: "Can you walk me home please? I don't want to go alone and want to make sure I'm safe."
                choice = 0
                ForcedtoWalkHome = true
            Else
                "Should I offer to walk <CurrentCompanion.name> home?"
                0:: "Yes"
                1:: "No"
                
            Endif
            
            If 0
                If !ForcedtoWalkHome
                   Player(Happy):: "Do you want me to walk you home? I just want to make sure you're safe."
                Endif
                If Dating || CurrentCompanion:attractiontoplayer > Random(0, 100) || CurrentCompanion:rapportwithplayer > Random(0, 100)
                    If !ForcedtoWalkHome
                        CurrentCompanion(Happy):: "Oh, thank you! That's very nice of you."
                    Endif
                    "I chivalrously walked with <CurrentCompanion.name> back to <CurrentCompanion.his_or_her> place."
                    If CurrentCompanion.IsDating()
                        MoveTo(Home_Dating)
                    Endif
                    setBackground(streets)
                    passTime(0.1, 0.5)
                    "A while later ..."
                    If !CurrentCompanion.isProstitute()
                        Player:: "So here it is, we arrived. I guess I'll see you soon ..."
                    Endif
                    If [CurrentCompanion:masochist < -75 || masochist > 75] && CurrentCompanion:masochist < masochist && CurrentCompanion.isProstitute() && isModEnabled(sb_PimpYourGirl)
                        If Dating
                            CurrentCompanion(Flirty):: "Listen baby, don't leave just yet. I want you to stay with me."
                            ForcedtoStay = true
                            WalkedHome = true
                        Else
                            CurrentCompanion(Flirty):: "Wait, don't leave just yet."
                            CurrentCompanion(Flirty):: "You need to come in for a minute."
                            ForcedtoStay = true
                            WalkedHome = true
                        Endif
                    Elseif !Dating && [CurrentCompanion.isProstitute() || [CurrentCompanion:masochist > 75 && CurrentCompanion:masochist > masochist && CurrentCompanion:attractiontoplayer > 10]]
                        If CurrentCompanion.hadSex()
                            CurrentCompanion(Flirty):: "Don't leave just yet. Do you want to come in?"
                        Else
                            CurrentCompanion():: "Do you want to come in?"
                        Endif
                        0:: "Yes"
                        1:: "No"
                        
                        If 0
                            Player(Happy):: "Of course, I don't mind staying for a while."
                            CurrentCompanion(Excited):: "Hang on a minute. Let me just open the door."
                            WalkedHome = true
                        Else
                            CurrentCompanion:attractiontoplayer *= 1.1
                            Player(Happy):: "That's okay. I'd better get going. See you!"
                            CurrentCompanion():: "As you wish."
                            "We went our separate ways."
                            endDate()
                        Endif
                    Elseif Dating || CurrentCompanion:attractiontoplayer > Random(0, 100)
                        If Dating
                            CurrentCompanion(Flirty):: "Baby, don't leave just yet. Do you want to stay the night?"
                        Else
                            CurrentCompanion(Flirty):: "Wait, don't leave just yet."
                            CurrentCompanion(Flirty):: "I feel guilty making you walk all the way here. Do you want to come in for tea or something?"
                        Endif
                        0:: "Yes"
                        1:: "No"
                        
                        If 0
                            If Dating
                                Player(Happy):: "Of course, love."
                            Else
                                Player(Happy):: "Of course, I don't mind staying for a while."
                            Endif
                            CurrentCompanion(Excited):: "Excellent! Hang on a minute. Let me just open the door."
                            WalkedHome = true
                        Else
                            CurrentCompanion:attractiontoplayer *= 1.05
                            Player(Happy):: "That's okay. I'd better get going. See you!"
                            "We went our separate ways."
                            endDate()
                        Endif
                    Else
                        endDate()
                    Endif
                Else
                    CurrentCompanion(Surprised)::"No, thank you. I wouldn't want to bother you. I'm happy to walk home myself."
                    "I couldn't really insist on it, so we waved goodbye and went our separate ways."
                Endif
            Else
                "I decided not to offer to walk <CurrentCompanion.him_or_her> back. We said goodbye and parted ways."
                endDate()
            Endif
        Endif

        If !FollowUpScene && WalkedHome && CurrentCompanion.isProstitute() && isModEnabled(sb_PimpYourGirl)
            PMoneyToday = MoneyToday.getGlobal()
            PCustomersToday = CustomersToday.getGlobal()
            If PMoneyToday > 0 || PCustomersToday > 0
                "While <CurrentCompanion.he_or_she> is opening the door, you are checking the money from <CurrentCompanion.name>'s work ..."
                If PMoneyToday > 0
                    PMoneyTodayConverted = PMoneyToday.convertToLocalCurrency(true)
                    "<CurrentCompanion.name> made you <PMoneyTodayConverted> today."
                    mood += 5
                Elseif PCustomersToday > 0
                    "Despite the fact that <CurrentCompanion.name> had sex with <PCustomersToday> guys today, you lost some money."
                    mood -= 35
                Endif
                If PCustomersToday > 0 && !CurrentCompanion.isMale()
                    "You look at <CurrentCompanion.him_or_her> ... if you remember correctly <CurrentCompanion.he_or_she> had sex with <PCustomersToday> guys today ..."
                    If PCustomersToday < 3
                        "<CurrentCompanion.name>'s hair is messy and you can see some cumstains on <CurrentCompanion.his_or_her> clothes."
                    Elseif PCustomersToday < 7
                        "<CurrentCompanion.name>'s hair and makeup are messy and <CurrentCompanion.his_or_her> face is still a little bit sticky from cum."
                    Elseif PCustomersToday < 12
                        "<CurrentCompanion.name>'s hair and makeup are a total mess and <CurrentCompanion.his_or_her> skin and especially <CurrentCompanion.his_or_her> face is covered with cum."
                        If CurrentCompanion:fitness < PCustomersToday*2
                            "<CurrentCompanion.He_or_She> seems exhausted ..."
                        Endif
                    Else
                        "<CurrentCompanion.name>'s hair, makeup and clothes are totally ruined and <CurrentCompanion.his_or_her> skin and especially <CurrentCompanion.his_or_her> face is covered with cum. Some of is also visible in <CurrentCompanion.his_or_her> hair."
                        If CurrentCompanion:fitness < PCustomersToday*2
                            "<CurrentCompanion.He_or_She> seems totally exhausted ..."
                        Endif
                    Endif
                Endif
                setBackground3D(Modules/sb_PimpYourGirl/Bedrooms/Prostitute02.lpworld)
                If PCustomersToday > 0 && !ForcedtoStay && CurrentCompanion.hadSex() && CurrentCompanion:masochist > masochist && isModEnabled(vin_NTR)
                    If CurrentCompanion:masochist > 0
                        "Maybe I should tell <CurrentCompanion.him_or_her> to take a shower before we sit together?"
                    Else
                        "<CurrentCompanion.name> wants to take a shower before we sit together, do you insist <CurrentCompanion.he_or_she> doesn't?"
                    Endif
                    0:: "Tell <CurrentCompanion.him_or_her> to take a shower"
                    1:: "No, <CurrentCompanion.he_or_she> should stay with me"
                    
                    If 0
                        CurrentCompanion.hide()
                        "<CurrentCompanion.name> went to the bathroom and took a shower ..."
                        If CurrentCompanion:perversion > 75 || hadSex()
                            CurrentCompanion.strip()
                            CurrentCompanion.dressExcept(Outerwear, Top, Bottom, Foot, Headwear, Eyewear)
                            CurrentCompanion.show(2)
                            "After a while <CurrentCompanion.he_or_she> came back relaxed, wearing only underwear."
                            HadAShower = true
                            arousal += 5
                        Else
                            CurrentCompanion.show(2)
                            "After a while <CurrentCompanion.he_or_she> came back, looking good and somewhat relaxed."
                        Endif
                        passTime(0.1, 0.5)
                        PCustomersToday = 0
                        CustomersToday.clearGlobal()
                        MoneyToday.clearGlobal()
                    Endif
                Elseif PCustomersToday > 0 && !ForcedtoStay && CurrentCompanion.hadSex() && CurrentCompanion:masochist < masochist && isModEnabled(vin_NTR)
                    If CurrentCompanion:masochist < -50
                        CurrentCompanion(Flirty):: "I should take a shower before we sit together, but I don't want too. I hope you don't mind."
                        CurrentCompanion:masochist -= Random(0,0.1)
                        masochist += Random(0,0.1)
                    Else
                        CurrentCompanion(Flirty):: "I should take a shower before we sit together, but I don't want too. Only if you insist."
                        0:: "Ask <CurrentCompanion.him_or_her> to take a shower"
                        1:: "No, <CurrentCompanion.he_or_she> should stay with me"
                        
                        If 0
                            CurrentCompanion.hide()
                            "<CurrentCompanion.name> went to the bathroom and took a shower ..."
                            If CurrentCompanion:perversion > 75 || hadSex()
                                CurrentCompanion.strip()
                                CurrentCompanion.dressExcept(Outerwear, Top, Bottom, Foot, Headwear, Eyewear)
                                "After a while <CurrentCompanion.he_or_she> came back relaxed, wearing only underwear."
                                CurrentCompanion.show(2)
                                arousal += 5
                                CurrentCompanion:arousal += 5
                            Else
                                CurrentCompanion.show(2)
                                "After a while <CurrentCompanion.he_or_she> came back, looking good and somewhat relaxed."
                            Endif
                            passTime(0.1, 0.5)
                            PCustomersToday = 0
                            CustomersToday.clearGlobal()
                            MoneyToday.clearGlobal()
                            masochist -= Random(0,1)
                            CurrentCompanion:masochist += Random(0,1)
                        Else
                            CurrentCompanion:masochist += Random(0,0.1)
                            masochist -= Random(0,0.1)
                        Endif
                    Endif
                Elseif PCustomersToday > 0 && !ForcedtoStay 
                    CurrentCompanion.hide()
                    "<CurrentCompanion.name> went to the bathroom and took a shower ..."
                    0:: "Peep a bit"
                    1:: "No thanks"
                    
                    If 0
                        "I need to see this ..."
                        SneakGame()
                        If Random(0, 100) < sneak
                            "Fortunately for me, <CurrentCompanion.he_or_she> didn't lock the door, allowing to sneak behind it to get a decent view of <CurrentCompanion.him_or_her> in all <CurrentCompanion.his_or_her> glory."
                            CurrentCompanion.strip()
                            CurrentCompanion.show(3)
                            setBackground(shower)
                            Filter(Shower)
                            Sex(CurrentCompanion)
                            arousal += Random(0, 20)
                            CurrentCompanion.hide()
                            If CurrentCompanion.isProstitute() && !CurrentCompanion.isDating() && !CurrentCompanion.LivesWithPlayer()
                                setBackground3D(Modules/sb_PimpYourGirl/Bedrooms/Prostitute02.lpworld)
                            Else
                                setBackground(home)
                            Endif
                        Else
                            "Unfortunately for me, <CurrentCompanion.he_or_she> locked the bathroom door. There's no way for me to have a look in."
                        Endif
                    Endif
                    CurrentCompanion.dress()
                    CurrentCompanion.show(2)
                    "After a while <CurrentCompanion.he_or_she> came back, looking good and somewhat relaxed."
                    passTime(0.1, 0.5)
                    PCustomersToday = 0
                    CustomersToday.clearGlobal()
                    MoneyToday.clearGlobal()
                Endif
            Endif
            
        Elseif !FollowUpScene && !WalkedHome && CurrentCompanion.isProstitute() && isModEnabled(sb_PimpYourGirl)
            PMoneyToday = MoneyToday.getGlobal()
            PCustomersToday = CustomersToday.getGlobal()
            If PCustomersToday > 0 || PMoneyToday > 0
                "You are checking the money again from todays work ..."
                If PMoneyToday > 0
                    "<CurrentCompanion.name> made you <PMoneyToday> today."
                    mood += 5
                Else
                    "Despite the fact that <CurrentCompanion.name> had sex with <PCustomersToday> guys today, you lost some money."
                    mood -= 35
                Endif
            Endif
            endDate()
        Endif
        
        If WalkedHome && ForcedtoStay && PMoneyToday > 50 && isModEnabled(sb_PimpYourGirl)
            GiveMoney = false
            If CurrentCompanion.isProstitute() && !CurrentCompanion.isDating() && !CurrentCompanion.LivesWithPlayer()
                setBackground3D(Modules/sb_PimpYourGirl/Bedrooms/Prostitute02.lpworld)
            Else
                setBackground(home)
            Endif
            CurrentCompanion(Flirty)::"There is something I want to talk about ..."
            If Dating && isModEnabled(vin_NTR)
                CurrentCompanion(Flirty)::"Baby, I know you want to be my agent ... but I want all the money."
                CurrentCompanion(Flirty)::"I am the one who is selling my body ... and we both know you enjoy it ..."
                CurrentCompanion()::"So ... give it to me!"
                0:: "Give <CurrentCompanion.him_or_her> all the money you earned (<PMoneyTodayConverted>)"
                
                GiveMoney = true
                CurrentCompanion(Flirty)::"Thank you very much honey. You're the best."
            Else
                GiveBeating = false
                BeatenToDeath = false
                CurrentCompanion(Flirty)::"<Player.name>, I know you want to be my agent ... but I want ALL the money."
                CurrentCompanion(Flirty)::"I am the one who is selling <CurrentCompanion.his_or_her> body ... and we both know you enjoy it ..."
                CurrentCompanion()::"Give it to me!"
                0:: "Give <CurrentCompanion.him_or_her> all the money you earned (<PMoneyTodayConverted>)"
                1:: "Beat <CurrentCompanion.him_or_her> up and make <CurrentCompanion.him_or_her> regret <CurrentCompanion.he_or_she> ever asked"
                2:: "Show <CurrentCompanion.him_or_her> who's the boss!"
                3:: "Just go"
                
                If choice != 0 && masochist > 75 && isModEnabled(vin_NTR)
                    Player():: "(I can't ... I'm too afraid ... and in some way I enjoy this ...)"
                    Player():: "(I'll give <CurrentCompanion.him_or_her> what <CurrentCompanion.he_or_she> wants ...)"
                    CurrentCompanion(Flirty)::"Thank you very much. Good <Player.boy_or_girl>."
                    GiveMoney = true
                Elseif choice != 0 && martial < CurrentCompanion:martial && muscle < CurrentCompanion:muscle
                    Player():: "(I can't ... I'm too afraid ... <CurrentCompanion.name> is stronger than me ...)"
                    Player():: "(I'll give <CurrentCompanion.him_or_her> what <CurrentCompanion.he_or_she> wants ...)"
                    CurrentCompanion(Flirty)::"Thank you very much. Good <Player.boy_or_girl>."
                    GiveMoney = true
                Elseif 0
                    CurrentCompanion(Flirty)::"Thank you very much. Good <Player.boy_or_girl>."
                    GiveMoney = true
                Elseif 1
                    GiveBeating = true
                Elseif 2
                    karma -= Random(5,10)
                    "You grab <CurrentCompanion.his_or_her> hair and pull <CurrentCompanion.him_or_her> over to you. Holding <CurrentCompanion.his_or_her> face right infront of you."
                    CurrentCompanion.show(4)
                    CurrentCompanion(Pain):: "..."
                    Player(Angry):: "Listen very closely to what I have to say now."
                    Player(Angry):: "If you try this ever again, you'll regret that you exist ... you will do whatever I want, whenever I want! Understood?"
                    "<CurrentCompanion.name> tries to nod but <CurrentCompanion.he_or_she> can't because of your grip is so thight ..."
                    CurrentCompanion(Pain):: "Ye ... yes ..."
                    Player(Angry):: "Yes, what?"
                    CurrentCompanion():: "Yes I got it, I'm sorry ..."
                    0:: "Rape <CurrentCompanion.him_or_her> to put <CurrentCompanion.him_or_her> in <CurrentCompanion.his_or_her> place"
                    1:: "Beat <CurrentCompanion.him_or_her> up and make <CurrentCompanion.him_or_her> regret <CurrentCompanion.he_or_she> ever asked"
                    2:: "That's enough"
                    
                    CurrentCompanion:masochist += Random(10,20)
                    CurrentCompanion:rapportwithplayer -= Random(10,30)
                    CurrentCompanion:attractiontoplayer += Random(10,30)
                    masochist -= Random(0,10)
                    
                    If 0
                        CurrentCompanion.strip()
                        Player(Angry):: "I'll show you where you belong!"
                        Filter(Aggressive)
                        TalkNonConsensual()
                        SexNoAffair(Player, CurrentCompanion)
                        Player.show(0)
                        CurrentCompanion.show(4)
                        CurrentCompanion(Crying):: "... ghnnnnaaaa ..."
                        karma -= Random(15,20)
                        CurrentCompanion:masochist += Random(20,40)
                        CurrentCompanion:rapportwithplayer -= Random(10,40)
                        CurrentCompanion:attractiontoplayer -= Random(10,40)
                        masochist -= Random(0,10)
                        WalkedHome = false
                    Elseif 1
                        GiveBeating = true
                    Elseif 2
                        CurrentCompanion(Flirty):: "I'm sorry I asked. Do you still want to stay for a bit?"
                        CurrentCompanion:arousal += Random(40,50)
                    Endif
                Endif
                
                If GiveMoney
                    "You lost <PMoneyTodayConverted>."
                    money -= PMoneyToday
                    karma += Random(0.1,0.5)
                    CurrentCompanion:masochist -= Random(0,1)
                    CurrentCompanion:rapportwithplayer += Random(0,2)
                    CurrentCompanion:attractiontoplayer -= Random(0,2)
                    CurrentCompanion:arousal += Random(10,20)
                    masochist += Random(0,1)
                Endif
                
                If GiveBeating
                    "You try to hit <CurrentCompanion.name>!"
                    If martial > CurrentCompanion:martial || muscle > CurrentCompanion:muscle || Random(0,100) > 99
                        "You beat the shit out of <CurrentCompanion.him_or_her> ..."
                        CurrentCompanion(Crying):: "... ghnnnnaaaa ..."
                        karma -= Random(5,10)
                        CurrentCompanion:masochist += Random(20,30)
                        CurrentCompanion:rapportwithplayer -= Random(10,30)
                        CurrentCompanion:attractiontoplayer -= Random(10,30)
                        masochist -= Random(0,10)
                        Player(Happy):: "I've gotta go now. Thank you for inviting me in."
                        CurrentCompanion(Crying):: "..."
                        "We parted ways."
                        WalkedHome = false
                        Ongoing = false
                    Else
                        "Damn ... <CurrentCompanion.he_or_she> is a good fighter ..."
                        Player(Angry):: "Ouch!"
                        If CurrentCompanion:martial - martial > 50 || martial + karma < -50
                            CustomersToday.clearGlobal()
                            MoneyToday.clearGlobal()
                            followUp(death)
                            CurrentCompanion:masochist -= Random(20,30)
                            CurrentCompanion:rapportwithplayer -= 100
                            CurrentCompanion:attractiontoplayer -= 100
                            masochist += Random(0,10)
                            blockContact(CurrentCompanion)
                            CurrentCompanion.hide()
                            BeatenToDeath = true
                            WalkedHome = false
                            Ongoing = false
                        Else
                            "You fight back, but you don't stand a chance ..."
                            CurrentCompanion:masochist -= Random(20,30)
                            CurrentCompanion:rapportwithplayer -= 100
                            CurrentCompanion:attractiontoplayer -= 100
                            masochist += Random(0,10)
                            CurrentCompanion(Angry):: "Go and search for someone else! I'm out!"
                            blockContact(CurrentCompanion)
                            CurrentCompanion.hide()
                            setBackground(streets)
                            "You lost <PMoneyTodayConverted>."
                            money -= PMoneyToday
                            Player():: "..."
                            karma -= Random(0,1)
                            WalkedHome = false
                            Ongoing = false
                        Endif
                    Endif
                Elseif !WalkedHome && !BeatenToDeath
                    Player(Happy):: "I've gotta go now. Thank you for inviting me in."
                    CurrentCompanion(Crying):: "..."
                    "We parted ways."
                    WalkedHome = false
                    Ongoing = false
                Else
                    CurrentCompanion.show(2)
                Endif
            Endif
        Endif
        
        If FollowUpScene || BNurseProstitute == CurrentCompanionID
            If CurrentCompanion.isProstitute()
                setBackground3D(Modules/sb_PimpYourGirl/Bedrooms/Prostitute02.lpworld)
            Else
                setBackground(home)
            Endif
            CanBeSurprised = false
        Elseif WalkedHome && CurrentCompanion.isRelative() && !CurrentCompanion.livesWithPlayer()
            If CurrentCompanion.isProstitute()
                setBackground3D(Modules/sb_PimpYourGirl/Bedrooms/Prostitute02.lpworld)
            Else
                setBackground(home)
            Endif
            "We're now inside of <CurrentCompanion.relationship>'s apartment."
            CanBeSurprised = true
        Elseif WalkedHome && [[isPlayerMarried() && Dating] || [Dating && !isPlayerMarried() && [!PlayerHasHome() || !DatingHasHome()]]]
            setBackground(home)
            "We're now inside our apartment."
            CanBeSurprised = false
            moveTo(home)
        Elseif WalkedHome && CurrentCompanion.isRelative() && CurrentCompanion.livesWithPlayer()
            setBackground(home)
            "We're now at home."
            CanBeSurprised = true
            moveTo(home)
        Elseif WalkedHome && !isPlayerMarried() && Dating
            setBackground(home)
            "We're now inside my <CurrentCompanion.boyfriend_or_girlfriend>'s apartment."
            CanBeSurprised = true
            moveTo(Home_Dating)
        Elseif WalkedHome && !isPlayerMarried()
            If CurrentCompanion.isProstitute()
                setBackground3D(Modules/sb_PimpYourGirl/Bedrooms/Prostitute02.lpworld)
            Else
                setBackground(home)
            Endif
            "We're now inside <CurrentCompanion.his_or_her> apartment."
            CanBeSurprised = true
        Endif
        
        If DebugLog && CanBeSurprised
            "Player and companion could get surprised together!"
        Endif
        
        If WalkedHome || FollowUpScene
            choice = -1
            ate = false
            hadSex = false
            Flirts = 0
            Vanilla = IsModEnabled(vin_VanillaRealistic)
            Ongoing = true
            NextScene = false
            UsedRapeDrug = false
            UsedAphrodisiac = false
            SpikeCatched = false
            WatchedMovies = 0
            GaveFlowers = false
            ChangedOpenRelationship = false
            ManipulateFail = false
            SubmissionStep = false
            DominanceStep = false
            PerversionStep = false
            
            If MyHome
                If CurrentCompanion.livesWithPlayer() || [CurrentCompanion.isDating() && isPlayerMarried()] || [CurrentCompanion.isDating() && !isPlayerMarried() && [!PlayerHasHome() || !DatingHasHome()]]
                    LeaveString = "Politely ask <CurrentCompanion.him_or_her> to go to <CurrentCompanion.his_or_her> room"
                Else
                    LeaveString = "Politely ask <CurrentCompanion.him_or_her> to leave"
                Endif
            Else
                LeaveString = "Leave"
            Endif
            
            If CurrentCompanion.isDating() && !OpenRelationship()
                StartRelationShipString = "Start open relationship"
            Elseif CurrentCompanion.isDating() && OpenRelationship()
                StartRelationShipString = "End open relationship"
            Elseif CurrentCompanion.isDating() && !isPlayerMarried()
                StartRelationShipString = "Propose Marriage"
            Elseif !CurrentCompanion.isContactExchanged()
                StartRelationShipString = "Ask for <CurrentCompanion.his_or_her> number"
            Else
                StartRelationShipString = "Start relationship"
            Endif
            
            If !IsPlayerMarried() && CurrentCompanion.isDating()
                EndRelationShipString = "Break up!"
            Elseif IsPlayerMarried() && CurrentCompanion.isDating()
                EndRelationShipString = "Divorce!"
            Else
                EndRelationShipString = "Encourage <CurrentCompanion.him_or_her> to end <CurrentCompanion.his_or_her> relationship"
            Endif
            
            While !NextScene && Ongoing
                Kissed = false
                NPCKissed = false
                tox = CurrentCompanion:intoxication
                If WearsCollar
                    CurrentCompanion.dressBondage(Bdg_Collar)
                Endif
                If !CurrentCompanion.isRelative() && CurrentCompanion.hadSex() && CurrentCompanion:masochist > 75 && masochist < -25
                    FlirtString = "Demand something"
                Elseif CurrentCompanion.isProstitute() && CurrentCompanion.hadSex() && CurrentCompanion:masochist > masochist && isModEnabled(sb_PimpYourGirl)
                    FlirtString = "Pimp Options"
                Else
                    FlirtString = "Flirt"
                Endif
                If !CurrentCompanion.isRelative()
                    "What should I suggest to <CurrentCompanion.name> that we do?"
                Else
                    "What should I suggest to my <CurrentCompanion.relationship> that we do?"
                Endif
                If DebugLog
                    CArousal = CurrentCompanion:arousal
                    CAttraction = CurrentCompanion:attractiontoplayer
                    CRapport = CurrentCompanion:rapportwithplayer
                    CIntox = CurrentCompanion:intoxication
                    CMaso = CurrentCompanion:masochist
                    CPerv = CurrentCompanion:perversion
                    "Companion - Arousal:<CArousal>  Attrac:<CAttraction>  Rapp:<CRapport>  Intox:<CIntox>  Maso:<CMaso>  Perv:<CPerv>"
                    CArousal = Player:arousal
                    CSneak = Player:sneak
                    CInter = Player:interpersonal
                    CIntel = Player:intelligence
                    CMaso = Player:masochist
                    CPerv = Player:perversion
                    "Player - Arousal:<CArousal>  Sneak:<CSneak>  Inter:<CInter>  Intel:<CIntel>  Maso:<CMaso>  Perv:<CPerv>"
                Endif
                If UsedRapeDrug
                    "(I have to wait until the drug kicks in ...)"
                Endif
                0:: "Chat"
                1:: !ate:: "Eat something together"
                2:: WatchedMovies < 5:: "Watch a movie"
                3:: "Drink alcohol"
                4:: "<FlirtString>"
                5:: "Talk about relationship"
                6:: "<LeaveString>"
                
                If CanBeSurprised && Random(0,100) > 75 && [CurrentCompanion.hasRelationship(Dating, Spouses) && Random(0,120) > CurrentCompanion:sneak && Random(0,120) > CurrentCompanion:intelligence] && [ hadSex || Kissed || Flirts > 2 ] && [CurrentCompanion:attractiontoplayer > 50 || CurrentCompanion:incest > 50]
                    CustomersToday.clearGlobal()
                    MoneyToday.clearGlobal()
                    followUp(goodbye_incoming_spouse)
                    NextScene = true
                Elseif !CurrentCompanion.isRelative() && CanBeSurprised && Random(0,100) > 75 && [CurrentCompanion.hasRelationship(ParentChild) && Random(0,120) > CurrentCompanion:sneak && Random(0,120) > CurrentCompanion:intelligence] && [ hadSex || Kissed || Flirts > 1 ]
                    CustomersToday.clearGlobal()
                    MoneyToday.clearGlobal()
                    followUp(goodbye_incoming_relative)
                    NextScene = true
                Elseif UsedRapeDrug || [CurrentCompanion:intoxication > CurrentCompanion:fitness && Random(0,100) > 50 && !CurrentCompanion.isAffair() && Player.isMale() && isModEnabled(vin_NonConsensual)]
                    If UsedRapeDrug
                        value = 1
                        PassedOutUsedRapeDrug.setGlobal(value)
                    Endif
                    If hadSex
                        value = 1
                        PassedOutHadSex.setGlobal(value)
                    Endif
                    If HadAShower
                        value = 1
                        PassedOutHadShower.setGlobal(value)
                    Endif
                    CustomersToday.clearGlobal()
                    MoneyToday.clearGlobal()
                    followUp(companion_knockedout)
                    NextScene = true
                Elseif 6 // LEAVE
                    Ongoing = false
                Elseif 5 // RELATIONSHIP
                    RelationTalk = true
                    While RelationTalk
                        0:: "Analyse <CurrentCompanion.him_or_her>"
                        1:: !StepFail:: "Manipulate <CurrentCompanion.him_or_her>"
                        2:: stock_flower > 0 && !GaveFlowers:: "Give <CurrentCompanion.him_or_her> flowers"
                        3:: !CurrentCompanion.isContactExchanged() || [!ChangedOpenRelationship && !CurrentCompanion.hasRelationship(Dating, Spouses) && CurrentCompanion.hadSex()]:: "<StartRelationShipString>"
                        4:: [NumberOfGirlfriends < 21 && Dating] || [CurrentCompanion.hasRelationship(Dating, Spouses) && !Dating]:: "<EndRelationShipString>"
                        5:: "Back"
                        
                        If 5
                            RelationTalk = false
                        Elseif 4 // END RELATIONSHIP
                            If Dating // BREAK UP OR DIVORCE
                                If masochist < Random(65,75) || CurrentCompanion:masochist > 0
                                    "Are you sure you want to break up with <CurrentCompanion.name>?"
                                    0:: "Yes"
                                    1:: "No"
                                    
                                    If 0 
                                        Player(Sad):: "Baby, I'm afraid our relationship isn't working anymore ..."
                                        CurrentCompanion(Suprised):: "..."
                                        Player.hide()
                                        CurrentCompanion.hide()
                                        If !isPlayerMarried()
                                            If NumberOfGirlfriends > 1
                                                "It was a difficult conversation to have, but I did it!"
                                                "I broke up with <CurrentCompanion.name>."
                                                mood -= 50
                                                CurrentCompanion.passOn()
                                                followUp(TNG_polygamy_breakup)
                                                Ongoing = false
                                                RelationTalk = false
                                            Else
                                                "It was a difficult conversation to have, but I did it!"
                                                "I broke up with <CurrentCompanion.name>. We just weren't meant for each other ..."
                                                mood -= 50
                                                LoseDating()
                                                Ongoing = false
                                                RelationTalk = false
                                            Endif
                                        Elseif isPlayerMarried()
                                            "It was a difficult conversation to have, but I did it!"
                                            "We agreed to divorce. We just weren't meant for each other ..."
                                            mood -= 100
                                            If NumberOfGirlfriends > 1
                                                setBackground(streets)
                                                CurrentCompanion.hide()
                                                Player.hide()
                                                If Player.isDominantSex(Dating) && money > 1000
                                                    "Unfortunately for me, the court awarded half of my hard-earned fortune to <CurrentCompanion.name> ... "
                                                    "What a disaster of a marriage that was ..."
                                                    money -= money*0.5
                                                Endif
                                                passTime(12,24)
                                                CurrentCompanion.passOn()
                                                followUp(TNG_polygamy_breakup)
                                                Ongoing = false
                                            Else
                                                setBackground(streets)
                                                CurrentCompanion.hide()
                                                Player.hide()
                                                LoseDating()
                                                Divorce()
                                                If Player.isDominantSex(Dating) && money > 1000
                                                    "Unfortunately for me, the court awarded half of my hard-earned fortune to <CurrentCompanion.name> ... "
                                                    "What a disaster of a marriage that was ..."
                                                    money -= money*0.5
                                                Endif
                                                passTime(12,24)
                                                Ongoing = false
                                            Endif
                                            RelationTalk = false
                                        Endif
                                        "We said goodbye and went our ways."
                                        moveTo(home)
                                    Endif
                                Else
                                    Player(Sad):: "(I would like to break up with <CurrentCompanion.him_or_her> ... but I'm too afraid ... <CurrentCompanion.He_or_She> would be so angry and disappointed ...)"
                                    CurrentCompanion(Suprised):: "Is there something you want to talk about? Why so serious?"
                                    Player(Flirty):: "No! No ... everything is fine."
                                Endif
                            Else // END COMPANION RELATIONSHIP
                                MaybeBreakUp = false
                                EncourageEndRelation = true
                                Step = 1
                                While EncourageEndRelation
                                    If CurrentCompanion:rapportwithplayer < Random(0,40)
                                        "<CurrentCompanion.name> glances at you ... <CurrentCompanion.he_or_she> looks like <CurrentCompanion.he_or_she>'s uncomfortable ..."
                                    Endif
                                    1:: Step == 1 && !StepFail:: "Step 1 - Listen to her"
                                    2:: Step == 2 && !StepFail:: "Step 2 - Talk about the future"
                                    3:: Step == 3 && !StepFail:: "Step 3 - Bring it up gently"
                                    4:: Step == 4 && !StepFail:: "Step 4 - Rebuild <CurrentCompanion.his_or_her> self-image"
                                    5:: Step == 5 && !StepFail:: "Step 5 - Air your concerns"
                                    6:: Step == 6 && !StepFail:: "Step 6 - Be honest and show your affection"
                                    7:: "Back"
                                    
                                    If 1 // END Relationship
                                        If CurrentCompanion.isMarried()
                                            EndRelWithThisSpouse = CurrentCompanion.getRelatedPerson(Spouses)
                                            Player(Flirty):: "Listen <CurrentCompanion.name> ... I really want to know more about you, are you happy? How's your relationship?"
                                            "<CurrentCompanion.name> starts talking ..."
                                            If [CurrentCompanion:attractiontoplayer < Random(25,50) || CurrentCompanion:incest < Random(25,50)] && [attractiveness < EndRelWithThisSpouse:attractiveness || CurrentCompanion:masochist > EndRelWithThisSpouse:masochist || !CurrentCompanion.isInterestedIn(Player)]
                                                "After a while, you realize <CurrentCompanion.he_or_she>'s very happy with <CurrentCompanion.his_or_her> <EndRelWithThisSpouse.husband_or_wife>."
                                                StepFail = true
                                            Else
                                                Random  
                                                    "It seems <CurrentCompanion.he_or_she>'s not very happy with <CurrentCompanion.his_or_her> <EndRelWithThisSpouse.husband_or_wife>."
                                                    "After some time, you realize <CurrentCompanion.he_or_she>'s not very happy."
                                                    "After some time, you found out that <CurrentCompanion.he_or_she>'s not happy."
                                                    "After a while, it's clear <CurrentCompanion.he_or_she>'s not very happy."
                                                    "It soon becomes clear that <CurrentCompanion.he_or_she>'s not very happy."
                                                    "After a few minutes, you realize <CurrentCompanion.he_or_she>'s not very happy with <CurrentCompanion.him_or_her> relationship."
                                                endRandom
                                                Step = 2
                                            Endif
                                            
                                        Else
                                            EndRelWithThisSpouse = CurrentCompanion.getRelatedPerson(Dating)
                                            Player(Flirty):: "Listen <CurrentCompanion.name> ... I really want to know more about you, are you happy? How's your relationship?"
                                            "<CurrentCompanion.name> starts talking ..."
                                            If [CurrentCompanion:attractiontoplayer < Random(25,50) || CurrentCompanion:incest < Random(25,50)] && [attractiveness < EndRelWithThisSpouse:attractiveness || CurrentCompanion:perversion < EndRelWithThisSpouse:perversion || !CurrentCompanion.isInterestedIn(Player)]
                                                "After a while, you realize <CurrentCompanion.he_or_she>'s very happy with <CurrentCompanion.his_or_her> <EndRelWithThisSpouse.boyfriend_or_girlfriend>."
                                                StepFail = true
                                            Else
                                                Random  
                                                    "It seems <CurrentCompanion.he_or_she>'s not very happy with <CurrentCompanion.his_or_her> <EndRelWithThisSpouse.boyfriend_or_girlfriend>."
                                                    "After some time, you realize <CurrentCompanion.he_or_she>'s not very happy."
                                                    "After some time, you found out that <CurrentCompanion.he_or_she>'s not happy."
                                                    "After a while, it's clear <CurrentCompanion.he_or_she>'s not very happy."
                                                    "It soon becomes clear that <CurrentCompanion.he_or_she>'s not very happy."
                                                    "After a few minutes, you realize <CurrentCompanion.he_or_she>'s not very happy with <CurrentCompanion.him_or_her> relationship."
                                                endRandom
                                                Step = 2
                                            Endif
                                        Endif
                                        
                                    Elseif 2 // END Relationship
                                            "You start telling <CurrentCompanion.him_or_her> about how you imagine your future is going to be ... a dream that you can live...with the right <CurrentCompanion.man_or_woman> by your side."
                                            If [CurrentCompanion:attractiontoplayer < Random(25,60) || CurrentCompanion:incest < Random(25,60)] && [attractiveness < EndRelWithThisSpouse:attractiveness || CurrentCompanion:masochist > EndRelWithThisSpouse:masochist || !CurrentCompanion.isInterestedIn(Player)]
                                                "After a while, you realize <CurrentCompanion.he_or_she> isn't really excited about what you have to say."
                                                StepFail = true
                                            Else
                                                Random
                                                    "After a while, you realize <CurrentCompanion.he_or_she> looks at you with a strange glow in <CurrentCompanion.his_or_her> eyes."
                                                    "<CurrentCompanion.name> glances at you with a strange glow in <CurrentCompanion.his_or_her> eyes."
                                                    "While you speak, <CurrentCompanion.he_or_she> glances at you and nods slowly ..."
                                                    "After a while you notice that <CurrentCompanion.he_or_she> looks at you with fascination and absorbs every word."
                                                endRandom
                                                Step = 3
                                                CurrentCompanion:attractiontoplayer += Random(0,2)
                                            Endif
                                            
                                    Elseif 3 // END Relationship
                                            "Slowly but purposefully you lead towards the topic and you try to make <CurrentCompanion.him_or_her> realize that <CurrentCompanion.he_or_she> has other choices ..."
                                            If [CurrentCompanion:attractiontoplayer < Random(25,70) || CurrentCompanion:incest < Random(25,70)] && [attractiveness < EndRelWithThisSpouse:attractiveness || CurrentCompanion:perversion > EndRelWithThisSpouse:perversion || !CurrentCompanion.isInterestedIn(Player)]
                                                "After a while, you realize <CurrentCompanion.he_or_she> isn't very receptive about what you have to say."
                                                StepFail = true
                                                CurrentCompanion:rapportwithplayer -= Random(0,2)
                                            Else
                                                Random
                                                    "Soon, you realize <CurrentCompanion.he_or_she> looks at you with a thoughtful expression ..."
                                                    "While you speak, <CurrentCompanion.he_or_she> looks at you with a thoughtful expression ..."
                                                    "<CurrentCompanion.name> looks at you with a thoughtful expression ..."
                                                endRandom
                                                Step = 4
                                            Endif
                                            
                                    Elseif 4 // END Relationship
                                            "It's important that you look after your own needs before you try to take care of someone else's ..."
                                            // "You're trying to make <CurrentCompanion.him_or_her> realize that it's important for <CurrentCompanion.him_or_her> to look after <CurrentCompanion.his_or_her> own needs ... "
                                            If [CurrentCompanion:attractiontoplayer < Random(25,80) || CurrentCompanion:incest < Random(25,80)] && [attractiveness < EndRelWithThisSpouse:attractiveness || CurrentCompanion:perversion > EndRelWithThisSpouse:perversion || !CurrentCompanion.isInterestedIn(Player)]
                                                "After a while, you realize <CurrentCompanion.he_or_she> isn't very receptive about what you have to say."
                                                StepFail = true
                                                CurrentCompanion:rapportwithplayer -= Random(0,2)
                                            Else
                                                Random
                                                    "After a while, you realize <CurrentCompanion.he_or_she> looks at you with a strange glow in <CurrentCompanion.his_or_her> eyes."
                                                    "After a while you notice that <CurrentCompanion.he_or_she> looks at you with fascination and absorbs every word."
                                                endRandom
                                                Step = 5
                                            Endif
                                            
                                    Elseif 5 // END Relationship
                                            // "You are carefully trying to guide the topic to the fact that you think <CurrentCompanion.his_or_her> relationship has no future ..."
                                             "I don't think your relationship with <EndRelWithThisSpouse.name> has a future ..."
                                            If [CurrentCompanion:attractiontoplayer < Random(25,90) || CurrentCompanion:incest < Random(25,90)] && [attractiveness < EndRelWithThisSpouse:attractiveness || CurrentCompanion:masochist > EndRelWithThisSpouse:masochist || !CurrentCompanion.isInterestedIn(Player)]
                                                "After a while, you realize <CurrentCompanion.he_or_she> isn't very receptive about what you have to say."
                                                StepFail = true
                                                CurrentCompanion:rapportwithplayer -= Random(0,2)
                                            Else
                                                Random
                                                    "While you speak, <CurrentCompanion.he_or_she> glances at you and nods slowly ..."
                                                    "<CurrentCompanion.name> glances at you and nods slightly ..."
                                                endRandom
                                                Step = 6
                                            Endif
                                            
                                    Elseif 6 // END Relationship
                                            "I would be the <Player.boyfriend_or_girlfriend> you always wished you could have. The one who will love you for everything that you are ..."
                                            // "You make it clear to <CurrentCompanion.him_or_her> that you would give <CurrentCompanion.him_or_her> a chance at any time if it turned out that you were right ..."
                                            If [CurrentCompanion:attractiontoplayer < Random(25,100) || CurrentCompanion:incest < Random(25,100)] && [attractiveness < EndRelWithThisSpouse:attractiveness || masochist > EndRelWithThisSpouse:masochist || !CurrentCompanion.isInterestedIn(Player)]
                                                "After a while, you realize <CurrentCompanion.he_or_she> isn't very receptive about what you have to say."
                                                StepFail = true
                                                CurrentCompanion:rapportwithplayer -= Random(0,2)
                                            Else
                                                If MyHome
                                                    CurrentCompanion():: "I've gotta go now ... our conversation was a little irritating, I need to think."
                                                    Player(Happy):: "Alright. Thank you for staying. Goodbye!"
                                                Else
                                                    CurrentCompanion():: "I think you'd better go... our conversation was a little irritating, I need to think."
                                                    "Getting the message from <CurrentCompanion.name>, I said goodbye."
                                                Endif
                                                MaybeBreakUp = true
                                                StepFail = true
                                                Ongoing = false
                                                RelationTalk = false
                                                EncourageEndRelation = false
                                            Endif
                                    Elseif 7 // END Relationship
                                        EncourageEndRelation = false
                                    Endif
                                    
                                    If MaybeBreakUp && [CurrentCompanion:attractiontoplayer > Random(20, 80) || CurrentCompanion:incest > Random(20, 80)] && CurrentCompanion.isInterestedIn(Player)
                                        setBackground(streets)
                                        CurrentCompanion.hide()
                                        Player.dress()
                                        Player.show(0)
                                        SheBrokeUp = true
                                        "The next day on facebook I saw that they broke up ..."
                                        removeNpcRelationship(CurrentCompanion, EndRelWithThisSpouse)
                                        If EndRelWithThisSpouse.isBoss()
                                            "To make things worse, my boss <EndRelWithThisSpouse.name> sent me an email:"
                                            EndRelWithThisSpouse(Angry):: "You are fired!"
                                            loseJob()
                                        Endif
                                        If EndRelWithThisSpouse.isLandlord()
                                            "And because <EndRelWithThisSpouse.name> is also my landlord, <EndRelWithThisSpouse.he_or_she> throwed my out of my apartment!"
                                            loseHome()
                                        Endif
                                        If EndRelWithThisSpouse.isContactExchanged()
                                            "And it seems that <EndRelWithThisSpouse.name> blocked me ..."
                                            blockContact(EndRelWithThisSpouse)
                                        Endif
                                    Elseif MaybeBreakUp
                                        setBackground(streets)
                                        CurrentCompanion.hide()
                                        Player.dress()
                                        Player.show(0)
                                        "The next day I tried to message <CurrentCompanion.name>, but <CurrentCompanion.he_or_she> didn't answer me ... "
                                        If CurrentCompanion.isRelative()
                                            CurrentCompanion:incest -= Random(0, 10)
                                        Else
                                            CurrentCompanion:attractiontoplayer -= Random(0, 10)
                                        Endif
                                        CurrentCompanion:rapportwithplayer -= Random(0, 10)
                                        EndRelWithThisSpouse:rapportwithplayer -= Random(0, 10)
                                    Endif
                                endWhile
                            
                            Endif
                        Elseif 3 // START RELATIONSHIP
                            If !CurrentCompanion.isContactExchanged()
                                Player(Happy):: "You know what? Let's exchange numbers so that we can keep in touch."
                                If CurrentCompanion:attractiontoplayer > Random(0, 30) || CurrentCompanion:rapportwithplayer > Random(0, 30) || CurrentCompanion:intoxication > Random(50, 100)
                                    CurrentCompanion(Excited):: "Of course! Let's exchange numbers!"
                                    exchangeContact(CurrentCompanion)
                                    StartRelationShipString = "Start relationship"
                                Else
                                    CurrentCompanion(Sad):: "I'm afraid I don't know you well enough yet for that. Maybe next time."
                                Endif
                            Elseif CurrentCompanion.isDating() && !OpenRelationship()
                                ChangedOpenRelationship = true
                                If masochist > Random(65,75) || CurrentCompanion:masochist < 0
                                    Player(Sad):: "(I would like to like to have an open relationship ... but I'm too afraid ... <CurrentCompanion.He_or_She> would be so angry and disappointed ...)"
                                    CurrentCompanion(Suprised):: "Is there something you want to talk about? Why so serious?"
                                    Player(Flirty):: "No! No ... everything is fine."
                                Else
                                    "Being quite open-minded, I sometimes feel a traditional relationship is too restricted. The commitment and the possessiveness just don't feel right."
                                    "Should I propose to my <CurrentCompanion.boyfriend_or_girlfriend> that we open up our relationship? So that I can sleep with whoever I want and <CurrentCompanion.name> can also sleep with whoever <CurrentCompanion.he_or_she> wants."
                                    0:: "Yes"
                                    1:: "No"
                                    
                                    If 0
                                        If Random(50, 200) < CurrentCompanion:attractiontoplayer + CurrentCompanion:perversion + CurrentCompanion:masochist
                                            CurrentCompanion(Flirty):: "You know what, honey? I have been feeling the same. Let's just make sure we tell each other all the dirty details!"
                                            startOpenRelationship()
                                            karma += 10
                                            StartRelationShipString = "End open relationship"
                                        Else
                                            CurrentCompanion(Angry):: "What on earth are you on about? Open up our relationship? No way! I can't bear the thought of you sleeping with other <CurrentCompanion.men_or_women> freely."
                                            CurrentCompanion:attractiontoplayer -= Random(0, 2)
                                        Endif
                                    Else
                                        "Nope, it may sound nice in theory but jealousy would kill our relationship."
                                    Endif
                                Endif
                            Elseif CurrentCompanion.isDating() && OpenRelationship()
                                ChangedOpenRelationship = true
                                DoEndOpenRelationShip = false
                                DramaEndOpenRelationship = false
                                If !CurrentCompanion.isProstitute()
                                    If masochist > Random(65,75) || CurrentCompanion:masochist < -75
                                        Player(Sad):: "(I would like to close our relationship ... but I'm too afraid of <CurrentCompanion.him_or_her> ... <CurrentCompanion.He_or_She> would be so angry and disappointed ...)"
                                        CurrentCompanion(Suprised):: "Is there something you want to talk about? Why so serious?"
                                        Player(Flirty):: "No! No ... everything is fine."
                                    Elseif
                                        If NumberOfGirlfriends > 0
                                            "Do you really want to break up with all other <CurrentCompanion.husband_or_wife>s except of <CurrentCompanion.name>?"
                                            0:: "Yes"
                                            1:: "No"
                                            
                                            If 0
                                                If JealousGirl.isValid() && !JealousGirl.isSameAs(CurrentCompanion)
                                                    If DebugLog
                                                        "INCOMING1: <JealousGirl.name>"
                                                    Endif
                                                    DramaEndOpenRelationship = true
                                                Else
                                                    If DebugLog
                                                        "INVALID1: <JealousGirl.name>"
                                                    Endif
                                                    DoEndOpenRelationShip = true
                                                Endif
                                            Endif
                                        Else
                                            If CurrentCompanion:masochist < masochist
                                                Player():: "I think it's time to close our relationship ... what do you think?"
                                                If CurrentCompanion:perversion > CurrentCompanion:attractiontoplayer || CurrentCompanion:perversion > 90
                                                    CurrentCompanion():: "I don't think so ... let's keep it open for now."
                                                Else
                                                    CurrentCompanion():: "I feel the same way. I thought of asking you first ... "
                                                Endif
                                                DoEndOpenRelationShip = true
                                            Else
                                                Player():: "I think it's time to close our relationship ... I only want to be with you."
                                                CurrentCompanion():: "I feel the same way. I thought of asking you first ... "
                                                DoEndOpenRelationShip = true
                                            Endif
                                        Endif
                                    Endif
                                    
                                    If DramaEndOpenRelationship
                                        "You tried to break up with <JealousGirl.name>, but <JealousGirl.he_or_she> got furious ..."
                                        "A few minutes later <JealousGirl.he_or_she> arrived at the doorstep."
                                        Player.show(4)
                                        JealousGirl.dress()
                                        JealousGirl.show(0)
                                        JealousGirl(Furious):: "ARE YOU OUT OF YOUR MIND??!"
                                        Player(Shocked):: "..."
                                        JealousGirl(Furious):: "You will NOT break up with me!"
                                        CurrentCompanion(Pain):: "..."
                                        JealousGirl(Furious):: "Don't even think about it!"
                                        If JealousGirl:masochist < masochist
                                            JealousGirl(Furious):: "You can fuck <CurrentCompanion.him_or_her>, but you'll not break up with ME! End of story!"
                                            0:: "Okay ..."
                                            
                                            If CurrentCompanion:masochist < JealousGirl:masochist || [CurrentCompanion:attractiontoplayer > JealousGirl:attractiontoplayer && CurrentCompanion:masochist < 0]
                                                CurrentCompanion(Furious):: "You bitch! <Player.He_or_She> is MINE now! Forget about <Player.him_or_her>!"
                                                JealousGirl(Furious):: "Arrggghhh ..."
                                                CurrentCompanion(Angry):: "YOU are out of your mind. Now get out of here!"
                                                CurrentCompanion(Angry):: "The descision is made."
                                                "<JealousGirl.Name> screamed at <CurrentCompanion.name> and slammed the door as <JealousGirl.he_or_she> went out ..."
                                                JealousGirl.hide()
                                                Player.show(0)
                                                CurrentCompanion(Happy):: "Problem solved."
                                                If isPlayerMarried() && Player.isMale() && !JealousGirl.isMale() && money > 0
                                                    setBackground(streets)
                                                    CurrentCompanion.hide()
                                                    Player.hide()
                                                    If NumberOfGirlfriends > 1
                                                        Divorces = NumberOfGirlfriends-1
                                                        "So I went through a complicated procedure of <Divorces> divorces ..."
                                                        "To make matters worse, <JealousGirl.name> ripped me appart in court, they awarded all of my hard-earned fortune to <DatingIncoming.name> ... What a disaster of a divorce that was ..."
                                                        money => 0
                                                    Else
                                                        "So I divorced <JealousGirl.name>"
                                                        "<JealousGirl.He_or_She> ripped me appart in court, they awarded all of my hard-earned fortune to <DatingIncoming.name> ... What a disaster of a divorce that was ..."
                                                        money => 0
                                                    Endif
                                                Endif
                                                DoEndOpenRelationShip = true
                                            Else
                                                "Then <JealousGirl.he_or_she> went out ..."
                                                JealousGirl.hide()
                                                Player():: "(WTF? Did that actually just happen??)"
                                                Player.show(0)
                                                DoEndOpenRelationShip = false
                                            Endif
                                        Else
                                            JealousGirl(Furious):: "You can fuck <CurrentCompanion.him_or_her>, but you'll not break up with me! End of story!"
                                            Player(Angry):: "No, YOU are out of your mind. I can and I will, now get out of here!"
                                            Player(Angry):: "The descision is made."
                                            CurrentCompanion(Happy):: "You see, <CurrentCompanion.he_or_she> is mine now."
                                            "<JealousGirl.Name> screamed at you and slammed the door as <JealousGirl.he_or_she> went out ..."
                                            JealousGirl.hide()
                                            Player.show(0)
                                            If isPlayerMarried() && Player.isMale() && !JealousGirl.isMale() && money > 0
                                                setBackground(streets)
                                                CurrentCompanion.hide()
                                                Player.hide()
                                                If NumberOfGirlfriends > 1
                                                    Divorces = NumberOfGirlfriends-1
                                                    "So I went through a complicated procedure of <Divorces> divorces ..."
                                                    "To make matters worse, <JealousGirl.name> ripped me appart in court, they awarded all of my hard-earned fortune to <DatingIncoming.name> ... What a disaster of a divorce that was ..."
                                                    money => 0
                                                Else
                                                    "So I divorced <JealousGirl.name>"
                                                    "<JealousGirl.He_or_She> ripped me appart in court, they awarded all of my hard-earned fortune to <DatingIncoming.name> ... What a disaster of a divorce that was ..."
                                                    money => 0
                                                Endif
                                            Endif
                                            DoEndOpenRelationShip = true
                                        Endif
                                    Endif
                                    
                                    If DoEndOpenRelationShip
                                        If isPlayerMarried()
                                            LoseDating()
                                            Divorce()
                                            CurrentCompanion.setDating()
                                            passTime(12,24)
                                            getMarried()
                                        Else
                                            LoseDating()
                                            CurrentCompanion.setDating()
                                        Endif
                                        karma += 10
                                        StartRelationShipString = "Start open relationship"
                                        RelationTalk = false
                                        Ongoing = false
                                        moveTo(home)
                                    Endif
                                    
                                Else
                                    If CurrentCompanion:masochist < masochist
                                        Player():: "I think it's time you quit selling your body and be with me in a closed relationship ... what do you think?"
                                        If CurrentCompanion:perversion > CurrentCompanion:attractiontoplayer || CurrentCompanion:perversion > 90
                                            CurrentCompanion():: "I don't think so ... it's too much fun, and I need the money."
                                        Endif
                                    Else
                                        CurrentCompanion():: "You know what, you are right. I'll stop selling my body for you ... I feel the same way."
                                        CurrentCompanion.removeProstitute()
                                        CurrentCompanion.setActorVar(tag_Whore, 0)
                                        forgiveAffairs()
                                        endOpenRelationship()
                                        karma += 10
                                    Endif
                                Endif
                            Else
                                CustomersToday.clearGlobal()
                                MoneyToday.clearGlobal()
                                followUp(start_relationship)
                                NextScene = true
                                RelationTalk = false
                            Endif
                        Elseif 2 // GIFTS AND SUPRISES
                            If [!CurrentCompanion.isRelative() || CurrentCompanion.hadSex()] && CurrentCompanion:masochist > masochist && [[perversion > 50 && arousal > 75] || CurrentCompanion.isDating()]
                                CurrentCompanion(Excited):: "Wow, you really do know what I like ..."
                                CurrentCompanion(Flirty):: "Aw, that's so sweet of you. You know what? I think you deserve more than a normal thank-you, don't you agree?"
                                If CurrentCompanion.isRelative()
                                    CurrentCompanion:incest += Random(0, 1)
                                Else
                                    CurrentCompanion:attractiontoplayer += Random(0, 1)
                                Endif
                                ThankYouSex = true
                            Elseif CurrentCompanion.isInterestedIn(Player)
                                CurrentCompanion(Excited):: "Wow, you really do know what I like ..."
                                CurrentCompanion(Flirty):: "Thank you <Player.name> for being so thoughtful ... that's very nice from you!"
                                If CurrentCompanion.isRelative()
                                    CurrentCompanion:incest += Random(0, 1)
                                Else
                                    CurrentCompanion:attractiontoplayer += Random(0, 1)
                                Endif
                            Else
                                CurrentCompanion():: "Oh yeah, thank you ..."
                                CurrentCompanion():: "..."
                            Endif
                            GaveFlowers = true
                        Elseif 1 // MANIPULATE
                            ManipulateCompanion = true
                            While ManipulateCompanion
                                If CurrentCompanion:rapportwithplayer < Random(0,40)
                                    "<CurrentCompanion.name> glances at you ... <CurrentCompanion.he_or_she> looks like <CurrentCompanion.he_or_she>'s uncomfortable ..."
                                Endif
                                1:: !SubmissionStep && !ManipulateFail:: "Push <Companion.him_or_her> around (Submission)"
                                2:: !SubmissionStep && !ManipulateFail:: "Make <Companion.him_or_her> feel bad about <Companion.himself_or_herself> (Submission)"
                                3:: !DominanceStep && !ManipulateFail:: "Encourage more self-determination (Dominance)"
                                4:: !DominanceStep && !ManipulateFail:: "Put yourself underneath <CurrentCompanion.him_or_her> (Dominance)"
                                5:: !PerversionStep && !ManipulateFail:: "Motivate <CurrentCompanion.him_or_her> to be more sexual (Perversion)"
                                6:: !PerversionStep && !ManipulateFail:: "Convince <CurrentCompanion.him_or_her> that morals are very important (Perversion)"
                                7:: "Back"
                                
                                If [CurrentCompanion:interpersonal > Random(75,100) && interpersonal < CurrentCompanion:interpersonal] || [CurrentCompanion:intelligence > Random(75,100) && intelligence < CurrentCompanion:intelligence]
                                    karma -= Random(0, 1)
                                    "After a short time talking ..."
                                    CurrentCompanion():: "..." 
                                    CurrentCompanion(Angry):: "Are you trying to manipulate me with this?"
                                    Player():: "(Damn!)"
                                    If CurrentCompanion.isRelative()
                                        CurrentCompanion:incest -= Random(0, 10)
                                    Else
                                        CurrentCompanion:attractiontoplayer -= Random(0, 10)
                                    Endif
                                    CurrentCompanion:rapportwithplayer -= Random(0, 10)
                                    CurrentCompanion:arousal => 0
                                    If [[ 1 || 2 || 3 || 4] && CurrentCompanion:masochist < masochist] || [[5 || 6] && CurrentCompanion:perversion < Random(0,25)]
                                        If MyHome
                                            CurrentCompanion(Happy):: "I've gotta go now. Thank you for inviting me in."
                                            Player(Happy):: "Alright. Thank you for staying. Goodbye!"
                                        Else
                                            CurrentCompanion():: "I think you should better go now ... "
                                            "Getting the message from <CurrentCompanion.name>, I said goodbye."
                                        Endif
                                        "We parted ways."
                                        Ongoing = false
                                        ManipulateCompanion = false
                                        RelationTalk = false
                                    Endif
                                Endif
                                
                                If 1 && !ManipulateFail // Submission1
                                    karma -= Random(0, 1)
                                    If masochist < Random(-100, 100) && [CurrentCompanion:attractiontoplayer < Random(25,100) || CurrentCompanion:incest < Random(25,100)] && CurrentCompanion:rapportwithplayer < Random(25,100)
                                        "After a while, you realize <CurrentCompanion.he_or_she>'s not very receptive to it."
                                        ManipulateFail = true
                                    Else
                                        Random  
                                            "You push <CurrentCompanion.him_or_her> around and after some time, it seems <CurrentCompanion.name> is now more obedient."
                                            "You push <CurrentCompanion.him_or_her> around and after some time, you realize <CurrentCompanion.he_or_she> is now more submissive."
                                            "You push <CurrentCompanion.him_or_her> around and after a while, it's clear <CurrentCompanion.he_or_she>'s now more submissive."
                                            "You push <CurrentCompanion.him_or_her> around, it soon becomes clear that <CurrentCompanion.he_or_she> is now more obedient."
                                            "You push <CurrentCompanion.him_or_her> around and after a few minutes, you realize <CurrentCompanion.he_or_she> is now more submissive."
                                        endRandom
                                        CurrentCompanion:masochist += Random(0, 1)
                                        If CurrentCompanion:masochist > Random(50, 75)
                                            "It seems like <CurrentCompanion.he_or_she>'s enjoying it ..."
                                            If CurrentCompanion.isRelative()
                                                CurrentCompanion:incest += Random(0, 1)
                                            Else
                                                CurrentCompanion:attractiontoplayer += Random(0, 1)
                                            Endif
                                            CurrentCompanion:rapportwithplayer += Random(0, 1)
                                            CurrentCompanion:arousal += Random(0, 10)
                                        Endif
                                        SubmissionStep = true
                                        DominanceStep = true
                                    Endif
                                Elseif 2 && !ManipulateFail // Submission2
                                    karma -= Random(5, 10)
                                    If masochist < Random(-25, 100) && [CurrentCompanion:attractiveness > Random(50,100) || CurrentCompanion:fitness > Random(25,100)] && CurrentCompanion:rapportwithplayer < Random(25,100)
                                        "After a while, you realize <CurrentCompanion.he_or_she>'s getting mad."
                                        ManipulateFail = true
                                    Else
                                        Random  
                                            "You pulled out all the stops and after some time, it seems <CurrentCompanion.name> is about to cry."
                                            "You pulled out all the stops and after some time, you realize <CurrentCompanion.he_or_she> is about to cry."
                                            "You pulled out all the stops and after a while, it's clear <CurrentCompanion.he_or_she> is about to cry."
                                            "You pulled out all the stops, it soon becomes clear that <CurrentCompanion.he_or_she> is about to cry."
                                            "You pulled out all the stops and after a few minutes, you realize <CurrentCompanion.name> is about to cry."
                                        endRandom
                                        If CurrentCompanion.isRelative()
                                            CurrentCompanion:incest += Random(0, 3)
                                        Else
                                            CurrentCompanion:attractiontoplayer += Random(0, 3)
                                        Endif
                                        CurrentCompanion:masochist += Random(0, 4)
                                        CurrentCompanion:rapportwithplayer -= Random(0, 3)
                                        CurrentCompanion:arousal -= Random(20, 40)
                                        If CurrentCompanion:attractiveness < Random(25, 50)
                                            If CurrentCompanion.isRelative()
                                                "It seems like that hit my <CurrentCompanion.relationship> hard ..."
                                                CurrentCompanion:incest -= Random(0, 10)
                                            Else
                                                "It seems like that hit <CurrentCompanion.him_or_her> hard ..."
                                                CurrentCompanion:attractiontoplayer -= Random(0, 10)
                                            Endif
                                            CurrentCompanion:rapportwithplayer -= Random(0, 20)
                                            CurrentCompanion:arousal -= 100
                                        Endif
                                        SubmissionStep = true
                                        DominanceStep = true
                                    Endif
                                    
                                Elseif 3 && !ManipulateFail // Dominance1
                                    karma -= Random(0, 1)
                                    If masochist > Random(-100, 100) && [CurrentCompanion:attractiontoplayer < Random(25,100) || CurrentCompanion:incest < Random(25,100)] && CurrentCompanion:rapportwithplayer < Random(25,100)
                                        "After a while, you realize <CurrentCompanion.he_or_she>'s not very receptive to it."
                                        ManipulateFail = true
                                    Else
                                        Random  
                                            "After some time, it seems <CurrentCompanion.name> is now more confident."
                                            "After some time, you realize <CurrentCompanion.he_or_she> is now more confident."
                                            "After a while, it's clear <CurrentCompanion.he_or_she>'s now more confident."
                                            "It soon becomes clear that <CurrentCompanion.he_or_she> is now more confident."
                                            "After a few minutes, you realize <CurrentCompanion.he_or_she> is now more confident."
                                        endRandom
                                        CurrentCompanion:masochist -= Random(0, 1)
                                        If CurrentCompanion:masochist < Random(-75, -50)
                                            "It seems like <CurrentCompanion.he_or_she>'s enjoying it ..."
                                            If CurrentCompanion.isRelative()
                                                CurrentCompanion:incest += Random(0, 1)
                                            Else
                                                CurrentCompanion:attractiontoplayer += Random(0, 1)
                                            Endif
                                            CurrentCompanion:rapportwithplayer += Random(0, 1)
                                            CurrentCompanion:arousal += Random(0, 10)
                                        Endif
                                        SubmissionStep = true
                                        DominanceStep = true
                                    Endif
                                Elseif 4 && !ManipulateFail // Dominance2
                                    karma -= Random(0, 1)
                                    If masochist > Random(-100, 25) && [CurrentCompanion:attractiontoplayer < Random(50,100) || CurrentCompanion:incest < Random(25,100)] && CurrentCompanion:rapportwithplayer < Random(25,100)
                                        "After a while, you realize <CurrentCompanion.he_or_she>'s not very receptive to it."
                                        ManipulateFail = true
                                    Else
                                        Random  
                                            "You pulled out all the stops and after some time, it seems <CurrentCompanion.name> is starting to push you around more."
                                            "You pulled out all the stops and after some time, you realize <CurrentCompanion.he_or_she> is starting to push you around more."
                                            "You pulled out all the stops and after a while, it's clear <CurrentCompanion.he_or_she> is starting to push you around some more."
                                            "You pulled out all the stops, it soon becomes clear that <CurrentCompanion.he_or_she> is starting to push you around more."
                                            "You pulled out all the stops and after a few minutes, you realize <CurrentCompanion.name> is starting to push you around some more."
                                        endRandom
                                        If CurrentCompanion.isRelative()
                                            CurrentCompanion:incest -= Random(0, 3)
                                        Else
                                            CurrentCompanion:attractiontoplayer -= Random(0, 3)
                                        Endif
                                        CurrentCompanion:masochist -= Random(0, 4)
                                        CurrentCompanion:rapportwithplayer += Random(0, 3)
                                        CurrentCompanion:arousal -= Random(20, 40)
                                        If CurrentCompanion:masochist < Random(-75, -50)
                                            "It seems like <CurrentCompanion.he_or_she>'s enjoying it ..."
                                            If CurrentCompanion.isRelative()
                                                CurrentCompanion:incest -= Random(0, 10)
                                            Else
                                                CurrentCompanion:attractiontoplayer -= Random(0, 10)
                                            Endif
                                            CurrentCompanion:rapportwithplayer += Random(0, 20)
                                            CurrentCompanion:arousal += 100
                                            CurrentCompanion:masochist -= Random(0, 4)
                                        Endif
                                        SubmissionStep = true
                                        DominanceStep = true
                                    Endif
                                    
                                Elseif 5 && !ManipulateFail // Perversion1
                                    karma -= Random(0, 1)
                                    If perversion < Random(0, 100) && [CurrentCompanion:attractiontoplayer < Random(25,100) || CurrentCompanion:incest < Random(25,100)] && CurrentCompanion:rapportwithplayer < Random(25,100)
                                        "After a while, you realize <CurrentCompanion.he_or_she>'s not very receptive to it."
                                        ManipulateFail = true
                                    Else
                                        Random  
                                            "After some time, you realize <CurrentCompanion.name> seems to care more about sex now."
                                            "After some time, you realize <CurrentCompanion.name> seems to talk more open about sex now."
                                            "After a while, it's clear <CurrentCompanion.name> cares more about sex now."
                                            "It soon becomes clear that <CurrentCompanion.name> cares more about sex now."
                                            "After a few minutes, you realize <CurrentCompanion.name> seems to talk more open about sex now."
                                        endRandom
                                        CurrentCompanion:perversion += Random(0, 1)
                                        If CurrentCompanion:perversion > Random(75, 95)
                                            "It seems like <CurrentCompanion.he_or_she>'s enjoying talking about it ..."
                                            If CurrentCompanion.isRelative()
                                                CurrentCompanion:incest += Random(0, 1)
                                            Else
                                                CurrentCompanion:attractiontoplayer += Random(0, 1)
                                            Endif
                                            CurrentCompanion:rapportwithplayer += Random(0, 1)
                                            CurrentCompanion:arousal += Random(0, 10)
                                            CurrentCompanion:perversion += Random(0, 1)
                                        Endif
                                        PerversionStep = true
                                    Endif
                                Elseif 6 && !ManipulateFail // Perversion2
                                    karma += Random(0, 1)
                                    If interpersonal < Random(0, 100) && [CurrentCompanion:attractiontoplayer < Random(50,100) || CurrentCompanion:incest < Random(25,100)] && CurrentCompanion:rapportwithplayer < Random(25,100)
                                        "After a while, you realize <CurrentCompanion.he_or_she>'s not very receptive to it."
                                        ManipulateFail = true
                                    Else
                                        Random  
                                            "After some time, you realize <CurrentCompanion.name> seems to care more about <CurrentCompanion.his_or_her> reputation now."
                                            "After some time, you realize <CurrentCompanion.name> seems worried about <CurrentCompanion.his_or_her> reputation now."
                                            "After a while, it's clear <CurrentCompanion.name> cares more about <CurrentCompanion.his_or_her> reputation now."
                                            "It soon becomes clear that <CurrentCompanion.name> cares more about <CurrentCompanion.his_or_her> reputation now."
                                            "After a few minutes, you realize <CurrentCompanion.name> seems worried about <CurrentCompanion.his_or_her> reputation now."
                                        endRandom
                                        If CurrentCompanion.isRelative()
                                            CurrentCompanion:incest += Random(0, 3)
                                        Else
                                            CurrentCompanion:attractiontoplayer += Random(0, 3)
                                        Endif
                                        CurrentCompanion:perversion -= Random(0, 4)
                                        CurrentCompanion:rapportwithplayer += Random(0, 3)
                                        CurrentCompanion:arousal -= 100
                                        If CurrentCompanion:perversion < Random(0, 25)
                                            "It seems like <CurrentCompanion.he_or_she> seems uncomfortable ..."
                                            If CurrentCompanion.isRelative()
                                                CurrentCompanion:incest -= Random(0, 10)
                                            Else
                                                CurrentCompanion:attractiontoplayer -= Random(0, 10)
                                            Endif
                                            CurrentCompanion:arousal -= 100
                                            CurrentCompanion:perversion -= Random(0, 4)
                                            If OpenRelationship() && CurrentCompanion.isDating() && !CurrentCompanion.isProstitute()
                                                If CurrentCompanion:masochist > masochist
                                                    CurrentCompanion():: "I think it's time to close our relationship ... what do you think?"
                                                Else
                                                    CurrentCompanion():: "I think it's time to close our relationship ... I don't want this anymore."
                                                    endOpenRelationship()
                                                Endif
                                            Elseif CurrentCompanion.isProstitute() && isModEnabled(sb_PimpYourGirl)
                                                If CurrentCompanion:masochist > masochist
                                                    CurrentCompanion():: "I should stop selling my body ... what do you think?"
                                                Else
                                                    CurrentCompanion():: "You know what I'll stop selling my body for you ... I don't want this anymore."
                                                    CurrentCompanion.removeProstitute()
                                                    CurrentCompanion.setActorVar(tag_Whore, 0)
                                                Endif
                                            Endif
                                        Endif
                                        If CurrentCompanion.isNaked()
                                            CurrentCompanion():: "Okay, I'll get dressed now ... "
                                            CurrentCompanion.dress()
                                        Endif
                                        PerversionStep = true
                                    Endif
                                Elseif 7
                                    ManipulateCompanion = false
                                Endif
                            endWhile
                        Elseif 0 // ANALYZE
                            
                            If !Spouse.isValid()
                                Spouse = CurrentCompanion.getRelatedPerson(Spouses, Dating)
                                CompanionID = CurrentCompanion.getID()
                                SpouseID = Spouse.getID()
                                OpenWithID = CurrentCompanion.getActorVar(TNG_NPCOpenRelationShip)
                                OpenWith2ID = Spouse.getActorVar(TNG_NPCOpenRelationShip)
                            Endif
                            
                            If OpenWithID == SpouseID && OpenWith2ID == CompanionID
                                "As far as you know, <CurrentCompanion.name> has an open relationship ..."
                            Endif
                            
                            If CurrentCompanion.isDating() && !isPlayerMarried()
                                If NumberOfGirlfriends > 0
                                    "<CurrentCompanion.name> is your one of your <NumberOfGirlfriends> <CurrentCompanion.boyfriends_or_girlfriends>."
                                Else
                                    "<CurrentCompanion.name> is your <CurrentCompanion.boyfriend_or_girlfriend>."
                                Endif
                            Elseif CurrentCompanion.isDating()
                                If NumberOfGirlfriends > 0
                                    "<CurrentCompanion.name> is your one of your <NumberOfGirlfriends> <CurrentCompanion.husbands_or_wifes>."
                                Else
                                    "<CurrentCompanion.name> is your <CurrentCompanion.husband_or_wife>."
                                Endif
                            Elseif CurrentCompanion.isExRelative()
                                If NumberOfGirlfriends > 0
                                    "<CurrentCompanion.name> is your one of your <NumberOfGirlfriends> <CurrentCompanion.boyfriends_or_girlfriends>."
                                Else
                                    "<CurrentCompanion.name> is your <CurrentCompanion.boyfriend_or_girlfriend>."
                                Endif
                            Elseif CurrentCompanion.isRelative() && !CurrentCompanion.isDating()
                                "<CurrentCompanion.name> is your <CurrentCompanion.relationship>."
                            Endif
                            
                            If CurrentCompanion.isDating() && OpenRelationship()
                                "You both are currently in an open relationship."
                            Endif
                            
                            If !CurrentCompanion.isDating() && !CurrentCompanion.isRelative()
                                If CurrentCompanion:age < 20 && age > 40
                                    "<CurrentCompanion.He_or_She>'s still pretty young. It is refreshing to watch <CurrentCompanion.him_or_her> in <CurrentCompanion.his_or_her> youthful glow."
                                Elseif CurrentCompanion:age - age > 10
                                    "<CurrentCompanion.He_or_She> is a lot older than me ..."
                                    "If I had to guess, I'd say <CurrentCompanion.he_or_she>'s <CurrentCompanion:age> years old."
                                Elseif CurrentCompanion:age - age < 2 && CurrentCompanion:age - age > 0
                                    "<CurrentCompanion.He_or_She>'s about my age ..."
                                Elseif age - CurrentCompanion:age < 2 && age - CurrentCompanion:age > 0
                                    "<CurrentCompanion.He_or_She>'s about my age ..."
                                Elseif age - CurrentCompanion:age > 10
                                    "<CurrentCompanion.He_or_She>'s way younger than me ..."
                                    "If I had to guess, I'd say <CurrentCompanion.he_or_she>'s <CurrentCompanion:age> years old."
                                Endif
                            Endif
                            
                            If !CurrentCompanion.isDating() && !CurrentCompanion.isRelative()
                                If CurrentCompanion:attractiveness > 95
                                    "And <CurrentCompanion.his_or_her> appearance, <CurrentCompanion.he_or_she> looks absolutely <CurrentCompanion.great_or_gorgeous> ..."
                                Elseif CurrentCompanion:attractiveness > 65
                                    "And <CurrentCompanion.his_or_her> appearance, <CurrentCompanion.he_or_she> looks very <CurrentCompanion.handsome_or_beautiful> ..."
                                Elseif CurrentCompanion:attractiveness > 50
                                    "And <CurrentCompanion.his_or_her> appearance, <CurrentCompanion.he_or_she> looks nice ..."
                                Elseif CurrentCompanion:attractiveness < 20
                                    "And <CurrentCompanion.his_or_her> appearance, <CurrentCompanion.he_or_she>'s actually pretty ugly ..."
                                Else
                                    "And <CurrentCompanion.his_or_her> appearance, <CurrentCompanion.he_or_she>'s nothing special ..."
                                Endif
                            Endif
                            
                            If isModEnabled(sb_BeautyExpansion) && !CurrentCompanion.isMale() && !CurrentCompanion.hadSex()
                                LipsB = CurrentCompanion.getActorVar(sb_BP_PS_LipsB)
                                LipsC = CurrentCompanion.getActorVar(sb_BP_PS_LipsC)
                                BoobsB = CurrentCompanion.getActorVar(sb_BP_PS_BoobsB)
                                BoobsC = CurrentCompanion.getActorVar(sb_BP_PS_BoobsC)
                                BoobsD = CurrentCompanion.getActorVar(sb_BP_PS_BoobsD)
                                BoobsDD = CurrentCompanion.getActorVar(sb_BP_PS_BoobsDD)
                                BoobsMonster = CurrentCompanion.getActorVar(sb_BP_PS_BoobsMonster)
                                If BoobsB != 0 || BoobsC != 0 || BoobsD != 0
                                    "And I think she had a boob job."
                                Elseif BoobsDD != 0 || BoobsMonster != 0
                                    "I'm absolutely sure she had a boob job ... she's got really huge boobs!"
                                Endif
                                If LipsB != 0 || LipsC != 0
                                    "And I'm sure she had her lips done."
                                Endif
                            Endif
                            
                            If CurrentCompanion:attractiontoplayer > 95 || [CurrentCompanion.isRelative() && CurrentCompanion:incest > 75]
                                "Everyone can see, <CurrentCompanion.he_or_she>'s completely in love with you."
                            Elseif CurrentCompanion:attractiontoplayer > 55 || [CurrentCompanion.isRelative() && CurrentCompanion:incest > 25]
                                "It's very obvious, <CurrentCompanion.he_or_she> seems to be very fond of you."
                            Elseif CurrentCompanion:attractiontoplayer > 25 || [CurrentCompanion.isRelative() && CurrentCompanion:incest > 25]
                                "It's probably not very obvious, but <CurrentCompanion.he_or_she> seems to be very fond of you."
                            Elseif CurrentCompanion:attractiontoplayer > 0 || [CurrentCompanion.isRelative() && CurrentCompanion:incest > 0]
                                "It's not very obvious, but <CurrentCompanion.he_or_she> seems to like you."
                            Endif
                            
                            If CurrentCompanion:rapportwithplayer < 0 && CurrentCompanion:attractiontoplayer > 0
                                "You get the impression <CurrentCompanion.he_or_she> doesn't feel comfortable with you."
                            Elseif CurrentCompanion:rapportwithplayer < 0
                                "You get the impression <CurrentCompanion.he_or_she> doesn't care about you."
                            Endif
                            
                            // masochist
                            If CurrentCompanion:masochist == 100
                                "About <CurrentCompanion.his_or_her> character: <CurrentCompanion.He_or_She>'s completely obedient to me."
                            Elseif CurrentCompanion:masochist > 75
                                "About <CurrentCompanion.his_or_her> character: <CurrentCompanion.He_or_She> is totally submissive."
                            Elseif CurrentCompanion:masochist > 50
                                "About <CurrentCompanion.his_or_her> character: <CurrentCompanion.He_or_She> is very submissive."
                            Elseif CurrentCompanion:masochist > 25
                                "About <CurrentCompanion.his_or_her> character: <CurrentCompanion.He_or_She> is submissive."
                            Elseif CurrentCompanion:masochist < -75
                                "About <CurrentCompanion.his_or_her> character: <CurrentCompanion.He_or_She> has a really dominant personality."
                            Elseif CurrentCompanion:masochist < -50
                                "About <CurrentCompanion.his_or_her> character: <CurrentCompanion.He_or_She> has a dominant personality."
                            Elseif CurrentCompanion:masochist < -25
                                "About <CurrentCompanion.his_or_her> character: <CurrentCompanion.He_or_She> is very bossy."
                            Endif
                            
                            // perversion
                            If !CurrentCompanion.hadSex()
                                "Until I slept with <CurrentCompanion.him_or_her>, I cannot tell how good <CurrentCompanion.he_or_she> is in bed."
                            Elseif CurrentCompanion.hadSex() && CurrentCompanion:perversion > 95
                                "About <CurrentCompanion.his_or_her> skills in bed: As far as I can tell, <CurrentCompanion.he_or_she> is a complete <CurrentCompanion.pervert_or_slut>."
                            Elseif CurrentCompanion.hadSex() && CurrentCompanion:perversion > 75
                                "About <CurrentCompanion.his_or_her> skills in bed: As far as I can tell, <CurrentCompanion.he_or_she> is a very kinky <CurrentCompanion.bastard_or_slut>."
                            Elseif CurrentCompanion.hadSex() && CurrentCompanion:perversion > 50
                                "About <CurrentCompanion.his_or_her> skills in bed: As far as I can tell, <CurrentCompanion.he_or_she> is very experienced."
                            Elseif CurrentCompanion.hadSex() && CurrentCompanion:perversion > 25
                                "About <CurrentCompanion.his_or_her> skills in bed: As far as I can tell, <CurrentCompanion.he_or_she> has some experience."
                            Elseif CurrentCompanion.hadSex() && CurrentCompanion:perversion > 15
                                "About <CurrentCompanion.his_or_her> skills in bed: As far as I can tell, <CurrentCompanion.he_or_she> is okay."
                            Elseif CurrentCompanion.hadSex() && CurrentCompanion:perversion > 5
                                "About <CurrentCompanion.his_or_her> skills in bed: As far as I can tell, <CurrentCompanion.he_or_she> is not very experienced."
                            Endif
                            
                            // intelligence
                            If CurrentCompanion:intelligence < 20 && CurrentCompanion:intelligence < intelligence && intelligence > 50
                                "About <CurrentCompanion.his_or_her> intelligence: <CurrentCompanion.name> is so <CurrentCompanion.stupid_or_dumb>, it's painful to listen to <CurrentCompanion.him_or_her>."
                                intelligence -= Random(0,0.1)
                                masochist += Random(0,0.2)
                            Elseif CurrentCompanion:intelligence < 25 && CurrentCompanion:intelligence < intelligence
                                "About <CurrentCompanion.his_or_her> intelligence: Seems that <CurrentCompanion.name> is not the brightest bulb in the box ..."
                                masochist += Random(0,0.05)
                            Elseif CurrentCompanion:intelligence > 75 && CurrentCompanion:intelligence > intelligence
                                "About <CurrentCompanion.his_or_her> intelligence: Seems that <CurrentCompanion.name> has a lot to tell ... it's fun listening to <CurrentCompanion.him_or_her>."
                                CurrentCompanion:intelligence += Random(0, 0.1)
                            Endif
                            
                            // Status
                            If CurrentCompanion:intoxication > 95
                                "Hmmm ... and it looks like <CurrentCompanion.name> is wasted ..."
                            Elseif CurrentCompanion:intoxication > 75
                                "Hmmm ... and it looks like <CurrentCompanion.he_or_she>'s hammered ..."
                            Elseif CurrentCompanion:intoxication > 50
                                "Hmmm ... and it looks like <CurrentCompanion.he_or_she>'s having fun ..."
                            Elseif CurrentCompanion:intoxication > 25
                                "Hmmm ... and it seems <CurrentCompanion.name> is a little bit tipsy ..."
                            Endif
                            
                            If Aphrodisiac || CurrentCompanion:arousal > 90
                                "... and I can tell <CurrentCompanion.he_or_she> is horny as fuck!"
                            Endif
                        Endif
                    endWhile
                Elseif Dating && CurrentCompanion:masochist < 75 && CurrentCompanion:attractiontoplayer < Random(-100, 20) && !isPlayerMarried()
                    CurrentCompanion(Sad):: "Baby, I'm afraid this isn't working ..."
                    Player(Suprised):: "..."
                    Player.hide()
                    CurrentCompanion.hide()
                    "<CurrentCompanion.name> did it! <CurrentCompanion.He_or_She> broke up with me. Maybe it was something I did ... or we simply weren't meant for each other."
                    mood -= 100
                    If NumberOfGirlfriends > 1
                        CurrentCompanion.passOn()
                        followUp(TNG_polygamy_breakup)
                        Ongoing = false
                    Else
                        LoseDating()
                        Ongoing = false
                    Endif
                Else
                    If 0 // CHAT
                        If CurrentCompanion:intelligence < 10 && intelligence > 50 && Chats > 2
                            "I think that's enough chatting for now. I can't stand it any longer."
                        Elseif Chats > 5
                            "I think that's enough chatting for now. The conversation is becoming quite boring."
                        Else
                            "We simply sat and chat for a while ..."
                            CurrentCompanion:rapportwithplayer += Random(0, 3)
                            CurrentCompanion:intoxication -= Random(0,15)
                            If CurrentCompanion:intelligence < 10 && CurrentCompanion:intelligence < intelligence && intelligence > 50
                                If CurrentCompanion.isRelative()
                                    "My <CurrentCompanion.relationship> is so <CurrentCompanion.stupid_or_dumb>, it's painful to listen to <CurrentCompanion.him_or_her>."
                                Else
                                    "<CurrentCompanion.name> is so <CurrentCompanion.stupid_or_dumb>, it's painful to listen to <CurrentCompanion.him_or_her>."
                                Endif
                                intelligence -= Random(0,0.1)
                                masochist += Random(0,0.2)
                            Elseif CurrentCompanion:intelligence < 25 && CurrentCompanion:intelligence < intelligence
                                If CurrentCompanion.isRelative()
                                    "Seems that my <CurrentCompanion.relationship> is not the brightest bulb in the box ..."
                                Else
                                    "Seems that <CurrentCompanion.name> is not the brightest bulb in the box ..."
                                Endif
                                masochist += Random(0,0.05)
                            Elseif CurrentCompanion:intelligence > 75 && CurrentCompanion:intelligence > intelligence
                                If CurrentCompanion.isRelative()
                                    "Seems that my <CurrentCompanion.relationship> has a lot to tell ... it's fun listening to <CurrentCompanion.him_or_her>."
                                Else
                                    "Seems that <CurrentCompanion.name> has a lot to tell ... it's fun listening to <CurrentCompanion.him_or_her>."
                                Endif
                                CurrentCompanion:intelligence += Random(0, 0.1)
                            Elseif [Random(60,100) < intelligence || Random(60,100) < interpersonal] && [CurrentCompanion:intelligence < intelligence || CurrentCompanion:interpersonal < interpersonal]
                                If CurrentCompanion.isRelative()
                                    "My <CurrentCompanion.relationship> seems very impressed with what you have to say."
                                Else
                                    "<CurrentCompanion.name> seems very impressed with what you have to say."
                                    CurrentCompanion:attractiontoplayer += Random(0, 3)
                                Endif
                            Endif
                            // Status
                            If CurrentCompanion:intoxication > 95
                                If CurrentCompanion.isRelative()
                                    "Hmmm ... and it looks like my <CurrentCompanion.relationship> is wasted ..."
                                Else
                                    "Hmmm ... and it looks like <CurrentCompanion.name> is wasted ..."
                                Endif
                            Elseif CurrentCompanion:intoxication > 75
                                "Hmmm ... and it looks like <CurrentCompanion.he_or_she>'s hammered ..."
                            Elseif CurrentCompanion:intoxication > 50
                                "Hmmm ... and it looks like <CurrentCompanion.he_or_she>'s having fun ..."
                            Elseif CurrentCompanion:intoxication > 25
                                If CurrentCompanion.isRelative()
                                    "Hmmm ... and it seems my <CurrentCompanion.relationship> is a little bit tipsy ..."
                                Else
                                    "Hmmm ... and it seems <CurrentCompanion.name> is a little bit tipsy ..."
                                Endif
                            Endif
                            
                            If Aphrodisiac || CurrentCompanion:arousal > 90
                                "... and I can tell <CurrentCompanion.he_or_she> is horny as fuck!"
                            Endif
                            Chats += 1
                        Endif
                        passTime(0.1, 0.2)
                    Elseif 1 // ATE
                        ate = true
                        CurrentCompanion:rapportwithplayer += Random(0, 1)
                        CurrentCompanion:intoxication -= Random(0,15)
                        If Random(0,100) < cooking && CurrentCompanion:cooking < cooking
                            "You're cooking something. It seems that <CurrentCompanion.name> is very impressed by your cooking skills."
                            If !CurrentCompanion.isRelative()
                                CurrentCompanion:attractiontoplayer += Random(1, 3)
                            Endif
                        Else
                            "We made some quick snacks and enjoyed them together ..."
                        Endif
                        energy += 25
                        passTime(0.2, 0.4)
                    Elseif 2 // MOVIE
                        If CurrentCompanion:arousal > 50 && CurrentCompanion.isInterestedIn(Player) && CurrentCompanion:perversion > 50 && CurrentCompanion:masochist < -75 && CurrentCompanion:masochist < masochist && WatchedMovies > Random(0,2)
                            CurrentCompanion():: "I don't want to watch a movie, let's do something else ..."
                            
                        Elseif WatchedMovies == 0 && CurrentCompanion:perversion > 65 && CurrentCompanion:perversion < 95 && Random(0,100) > 98
                            If CurrentCompanion.isRelative()
                                "We tried to watch a movie ... but my <CurrentCompanion.relationship> still had a porn dvd in <CurrentCompanion.his_or_her> DVD player ..."
                            Else
                                "We tried to watch a movie ... but <CurrentCompanion.name> still had a porn dvd in <CurrentCompanion.his_or_her> DVD player ..."
                            Endif
                            If CurrentCompanion:masochist < -50
                                CurrentCompanion(Happy):: "Hups ... sorry ... hahahahaha"
                            Else
                                CurrentCompanion(Anxious):: "..."
                            Endif
                            If CurrentCompanion:perversion > 90 && Random(0,100) > 50
                                "It was a BBC gangbang scene with a girl having fun with countless dicks, sure it was from BLACKED ..."
                                perversion += 0.2
                            Elseif CurrentCompanion:perversion > 80 && masochist < -80 && !CurrentCompanion.isMale() && Random(0,100) > 50 && isModEnabled(vin_NTR)
                                "It was a some kind of cuckold porn where a guy licks out the cumfilled pussy of his wife ..."
                                perversion += 0.2
                            Elseif CurrentCompanion:perversion > 80 && masochist > 80 && CurrentCompanion.isMale() && Random(0,100) > 50 && isModEnabled(vin_NTR)
                                "It was a some kind of cuckold porn where a guy licks out the cumfilled pussy of his wife ..."
                                perversion += 0.2
                            Elseif CurrentCompanion:perversion > 80 && masochist < -80 && CurrentCompanion.isMale() && Random(0,100) > 50 && isModEnabled(vin_NonConsensual)
                                "It was one of this BDSM movies where women get raped ..."
                                perversion += 0.2
                            Elseif CurrentCompanion:perversion > 80 && masochist > 80 && !CurrentCompanion.isMale() && Random(0,100) > 50 && isModEnabled(vin_NonConsensual)
                                "It was one of this BDSM movies where women get raped ..."
                                perversion += 0.2
                            Elseif CurrentCompanion.isPregnant() && CurrentCompanion.countPregnancyDays() > 120 && CurrentCompanion:perversion > 75 && Random(0,100) > 50
                                "It was some kind of gangbang video with a pregnant woman ..."
                                perversion += 0.2
                            Elseif CurrentCompanion:masochist > 75 && CurrentCompanion.isTrans() && Random(0,100) > 50
                                "It was some kind of sissy hypno video ..."
                                perversion += 0.2
                            Elseif CurrentCompanion:perversion > 75 && CurrentCompanion.isTrans() && Random(0,100) > 50
                                "It was some kind of tranny gangbang video ..."
                                perversion += 0.2
                            Else
                                Random
                                    "It was some kind of high class porn movie ..."
                                    "It was some kind of amateur porn movie ..."
                                    "It was some kind of old and young movie ..."
                                endRandom
                            Else
                                If CurrentCompanion.isRelative()
                                    "My <CurrentCompanion.relationship> was very fast in hiding the movie ..."
                                Else
                                    "<CurrentCompanion.name> was very fast in hiding the movie ..."
                                Endif
                            Endif
                            If masochist < 0
                                "Interesting ..."
                                perversion += Random(0, 0.1)
                            Else
                                "WTF?"
                                perversion += Random(0, 0.1)
                            Endif
                            
                        Elseif CurrentCompanion.isFemale() && CurrentCompanion:masochist < -25 && CurrentCompanion:masochist < masochist && WatchedMovies > Random(0,2) && [CurrentCompanion:arousal < 50 || CurrentCompanion:perversion < 25 || !CurrentCompanion.isInterestedIn(Player)]
                            CurrentCompanion(Happy):: "Yeah! Let's watch some romantic comedy!"
                            If Player.isMale()
                                Player(Pain):: "Ouch ... "
                                intelligence -= Random(0, 0.1)
                                mood -= 50
                                energy -= Random(2,25)
                                arousal -= 50
                                masochist += Random(0, 0.1)
                            Else
                                Player(Happy):: "Okay ... why not ..."
                                arousal += 5
                                mood += Random(0, 50)
                            Endif
                            "We watched a romantic comedy together ..."
                            WatchedMovies += 5
                            CurrentCompanion:intoxication -= Random(0,5)
                            
                        Elseif CurrentCompanion.isFemale() && CurrentCompanion:perversion > 75 && CurrentCompanion:attractiontoplayer > 50 && CurrentCompanion:arousal > 50 && CurrentCompanion:masochist < -25 && CurrentCompanion:masochist < masochist && WatchedMovies > 0
                            CurrentCompanion(Happy):: "Yeah! Let's watch a porn movie!"
                            If masochist < 0 && perversion < 25
                                Player(Pain):: "What?! I must have misunderstood her ..."
                            Else
                                Player(Happy):: "Okay ... why not ..."
                            Endif
                            "<CurrentCompanion.name> went to <CurrentCompanion.his_or_her> room and came back with a porn movie ... we watched it together ..."
                            If CurrentCompanion:perversion > 90 && Random(0,100) > 50
                                "It was a BBC gangbang scene with a girl having fun with countless dicks, sure it was from BLACKED ..."
                                perversion += 0.2
                                If [masochist < 0 && perversion < 25] || !isModEnabled(vin_NTR)
                                    Player(Pain):: "WTF? This was disgusting!"
                                Endif
                                
                            Elseif CurrentCompanion:incest > 90 && Random(0,100) > 50
                                "It was a movie about a <CurrentCompanion.relationship> having fun with <CurrentCompanion.his_or_her> innocent <CurrentCompanion.callPlayer>, sure it was from Incest Taboo ..."
                                perversion += 0.2
                                If !isModEnabled(vin_Incest)
                                    Player(Pain):: "WTF? This was disgusting!"
                                Endif
                                
                            Elseif CurrentCompanion:perversion > 80 && masochist < -80 && Random(0,100) > 50 && isModEnabled(vin_NTR)
                                "It was a some kind of cuckold porn where a guy licks out the cumfilled pussy of his wife ..."
                                perversion += 0.2
                                masochist += 0.2
                                If masochist < 0 && perversion < 25
                                    Player(Pain):: "WTF? This was disgusting!"
                                Endif
                                
                            Elseif CurrentCompanion:perversion > 80 && masochist > 80 && Random(0,100) > 50 && isModEnabled(vin_NTR) && isModEnabled(sb_PimpYourGirl)
                                "It was a very weird story about a guy and his wife, where he made her selling her body to complete strangers ... and made her a total slut ..."
                                perversion += 0.2
                                masochist += 0.2
                                If masochist < 0 && perversion < 25
                                    Player(Pain):: "WTF? This was disgusting!"
                                Else
                                    Player(Happy):: "Interesting ..."
                                Endif
                                
                            Elseif CurrentCompanion:perversion > 80 && masochist < -80 && CurrentCompanion.isMale() && Random(0,100) > 50 && isModEnabled(vin_NonConsensual)
                                "It was one of this BDSM movies where women get raped ..."
                                perversion += 0.2
                                masochist -= 0.2
                                If masochist > 0 && perversion < 25 || !isModEnabled(vin_NonConsensual)
                                    Player(Pain):: "WTF? This was disgusting!"
                                Endif
                                
                            Elseif CurrentCompanion.isPregnant() && CurrentCompanion.countPregnancyDays() > 120 && CurrentCompanion:perversion > 75 && Random(0,100) > 50
                                "It was some kind of gangbang video with a pregnant woman ..."
                                perversion += 0.2
                                
                            Elseif CurrentCompanion:masochist < -75 && CurrentCompanion.isFemale() && Player.isMale() && Random(0,100) > 50
                                "It was some kind of sissy hypno video ..."
                                perversion += 0.2
                                masochist += 0.2
                                If masochist < 0 && perversion < 25
                                    Player(Pain):: "WTF? Does she want me to be her sissy??!"
                                Endif
                                
                            Elseif CurrentCompanion:perversion > 75 && CurrentCompanion.isTrans() && Random(0,100) > 50
                                "It was some kind of tranny gangbang video ..."
                                perversion += 0.2
                                
                            Else
                                Random
                                    "It was some kind of high class porn movie ..."
                                    "It was some kind of amateur porn movie ..."
                                    "It was some kind of old and young movie ..."
                                endRandom
                                
                            Endif
                            WatchedMovies += 5
                        
                        Else
                            "We watched a movie together ..."
                            WatchedMovies += 1
                            CurrentCompanion:intoxication -= Random(0,5)
                        Endif
                        passTime(1, 2)
                    Elseif 3 // DRINK
                        NPCdrinks = false
                        pregdays = CurrentCompanion.countPregnancyDays()
                        If CurrentCompanion:intelligence > 25 && [[CurrentCompanion.isPregnant() && pregdays > 100] || [XBPisPregnant > 0 && isModEnabled(sb_BetterPregnancy)]]
                            CurrentCompanion(Flirty):: "Sorry, I don't want ... you know ... I'm pregnant."
                            
                        Elseif !UsedRapeDrug && isModEnabled(sb_BetterPregnancy) && isModEnabled(vin_NonConsensual) && [!CurrentCompanion.hadSex() || !CurrentCompanion.isInterestedIn(Player)] && [CurrentCompanion:sneak < Random(0,100) || CurrentCompanion:intoxication > Random(0,100)]
                            If CurrentCompanion.isRelative()
                                "My <CurrentCompanion.relationship> isn't paying attention at the moment ..."
                                "It's maybe a VERY bad idea, but I could try to spike my <CurrentCompanion.relationship>'s drink with one of my pills ..."
                            Else
                                "<CurrentCompanion.He_or_She> isn't paying attention at the moment ..."
                                "It's maybe not the gentleman way, but I could try to spike <CurrentCompanion.his_or_her> drink with one of my pills ..."
                            Endif
                            0:: stock_chineseaphrodisiac > 0:: "Use chinese aphrodisiacs"
                            1:: stock_rapedrug > 0:: "Use rape drug"
                            2:: "Not now"
                            
                            If 0
                                SneakGame()
                                If Random(0, 200) < sneak
                                    If CurrentCompanion.isRelative()
                                        Player():: "(Done! This will make sure my <CurrentCompanion.relationship>'s <CurrentCompanion.cock_or_pussy> is <CurrentCompanion.hard_or_dripping> for me!)"
                                    Else
                                        Player():: "(Done! This will make sure <CurrentCompanion.his_or_her> <CurrentCompanion.cock_or_pussy> is <CurrentCompanion.hard_or_dripping> for me!)"
                                    Endif
                                    karma -= Random(5,10)
                                    CurrentCompanion:arousal += 1000
                                    Player:stock_chineseaphrodisiac -= 1
                                    UsedAphrodisiac = true
                                    NPCdrinks = true
                                Else
                                    Player(Surprised):: "(Oh, shit! I think she noticed something!)" 
                                    CurrentCompanion(Anxious):: "This drink tastes weird ..."
                                    If [CurrentCompanion:intelligence > Random(25,100) && CurrentCompanion:intoxication < 75] || SpikeCatched
                                        CurrentCompanion(Angry):: "WAIT! Did you put something in there?!"
                                        Player(Surprised):: "(Crap!)"
                                        If CurrentCompanion.isRelative()
                                            CurrentCompanion(Angry):: "I think you should go now!"
                                            "She doesn't think twice and tosses the drink in your face!"
                                            CurrentCompanion:incest -= 200
                                        Else
                                            CurrentCompanion(Angry):: "I don't think I ever want to see you again!"
                                            "She doesn't think twice and tosses the drink in your face before she kicks you out the door."
                                            CurrentCompanion:attractiontoplayer -= 200
                                            blockContact(CurrentCompanion)
                                        Endif
                                        CurrentCompanion:arousal -= 100
                                        CurrentCompanion:rapportwithplayer -= 200
                                        endDate()
                                        setBackground(streets)
                                        Player.dress()
                                        Player():: "At least she dumped the evidence on my face ..."
                                        Ongoing = false
                                    Else
                                        CurrentCompanion(Disgusted):: "I guess that was the wrong mixture, make me a new one!"
                                        Player():: "(Pfuh!)"
                                        SpikeCatched = true
                                        NPCdrinks = true
                                    Endif
                                Endif
                            Elseif 1
                                SneakGame()
                                If Random(0, 200) < sneak
                                    If CurrentCompanion.isRelative()
                                        Player():: "(Done! This will make sure my <CurrentCompanion.relationship> will be wasted and will not remember anything!)"
                                    Else
                                        Player():: "(Done! This will make sure <CurrentCompanion.he_or_she> will be wasted and will not remember anything!)"
                                    Endif
                                    karma -= Random(5,10)
                                    CurrentCompanion:arousal += 1000
                                    Player:stock_rapedrug -= 1
                                    UsedRapeDrug = true
                                    NPCdrinks = true
                                Else
                                    Player(Surprised):: "(Oh, shit! I think she noticed something!)" 
                                    CurrentCompanion(Anxious):: "This drink tastes weird ..."
                                    If [CurrentCompanion:intelligence > Random(25,100) && CurrentCompanion:intoxication < 75] || SpikeCatched
                                        CurrentCompanion(Angry):: "WAIT! Did you put something in there?!"
                                        Player(Surprised):: "(Crap!)"
                                        If CurrentCompanion.isRelative()
                                            CurrentCompanion(Angry):: "I think you should go now!"
                                            "She doesn't think twice and tosses the drink in your face!"
                                            CurrentCompanion:incest -= 200
                                        Else
                                            CurrentCompanion(Angry):: "I don't think I ever want to see you again!"
                                            "She doesn't think twice and tosses the drink in your face before she kicks you out the door."
                                            CurrentCompanion:attractiontoplayer -= 200
                                            blockContact(CurrentCompanion)
                                        Endif
                                        CurrentCompanion:arousal -= 100
                                        CurrentCompanion:rapportwithplayer -= 200
                                        endDate()
                                        setBackground(streets)
                                        Player.dress()
                                        Player():: "At least she dumped the evidence on my face ..."
                                        Ongoing = false
                                    Else
                                        CurrentCompanion(Disgusted):: "I guess that was the wrong mixture, make me a new one!"
                                        Player():: "(Pfuh!)"
                                        SpikeCatched = true
                                        NPCdrinks = true
                                    Endif
                                Endif
                            Endif
                        Elseif CurrentCompanion:masochist < -95 && Random(0,100) < 15 && CurrentCompanion:intoxication > 20 && CurrentCompanion.hadSex()
                            CurrentCompanion(Flirty):: "Wait, I have a better idea ..."
                            If !CurrentCompanion.isFemale()
                                "<CurrentCompanion.name> took your empty glass, held it to <CurrentCompanion.his_or_her> cock and started pissing.... <CurrentCompanion.he_or_she> didn't stop until it was filled to the brim."
                            Else
                                "<CurrentCompanion.name> took your empty glass, held it to <CurrentCompanion.his_or_her> pussy and started pissing.... <CurrentCompanion.he_or_she> didn't stop until it was filled to the brim."
                                Random 
                                    CurrentCompanion(Flirty):: "Sorry, I needed to pee so much ..."
                                    CurrentCompanion(Flirty):: "I needed to pee so much ... and I don't want to go all this way to the bathroom."
                                    CurrentCompanion(Flirty):: "You know I'm lazy, I didn't want to go to the bathroom."
                                    CurrentCompanion(Flirty):: "We both know you will love it ..."
                                    CurrentCompanion(Flirty):: "You love watching me pee, right?"
                                endRandom
                            Endif
                            
                            If CurrentCompanion.isRelative()
                                "With a bright smile your <CurrentCompanion.relationship> now holds it right in front of your face..."
                                CurrentCompanion(Flirty):: "That's your drink for this round ... your <CurrentCompanion.relationship>'s piss ... please be so kind and make me a martini."
                                "What will you do now?"
                                0:: "Drink your <CurrentCompanion.relationship>'s piss"
                                1:: "No way, this is DISGUSTING!"
                                
                            Else
                                "With a bright smile <CurrentCompanion.he_or_she> now holds it right in front of your face..."
                                CurrentCompanion(Flirty):: "That's your drink for this round ... please be so kind and make me a martini."
                                "What will you do now?"
                                0:: "Enjoy your drink"
                                1:: "No way, this is disgusting!"
                                
                            Endif
                            
                            If choice != 0 && masochist > 75 && Dating:masochist < -75 && isModEnabled(vin_NTR)
                                Player():: "(I can't ... I'm too afraid ... and in some way I enjoy this ...)"
                                Player():: "(I'll do what <Dating.he_or_she> wants ...)"
                                choice = 0
                            Endif
                            
                            If 0
                                "You two toast, and then you empty your glass ... you managed to drink it all up."
                                Dating(Flirty)::"You are such a good <Player.boy_or_girl>."
                                If perversion > 75
                                    CurrentCompanion(Flirty):: "Oh ... is that a smile? I knew you would enjoy it!"
                                Else
                                    CurrentCompanion(Flirty):: "It seems that it didn't taste so good ... you should get used to it ... hahaha"
                                Endif
                                perversion += Random(1,1.5)
                                masochist += Random(1,2)
                                mood -= Random(5,10)
                                energy -= Random(1,5)
                                toxfactor = 100
                                toxfactor -= CurrentCompanion:fitness
                                toxfactor = toxfactor/10
                                CurrentCompanion:intoxication += Random(1,6)*toxfactor
                                passTime(0.1, 0.2)
                                
                            Else
                                CurrentCompanion(Angry):: "You don't seem to appreciate what I'm doing for you. I think you should leave now."
                                If CurrentCompanion.isRelative()
                                    "Getting the message from my <CurrentCompanion.relationship>, I left."
                                    CurrentCompanion:incest -= Random(5, 20)
                                Else
                                    "Getting the message from <CurrentCompanion.name>, I said goodbye."
                                    CurrentCompanion:attractiontoplayer -= Random(5, 20)
                                    "We parted ways."
                                Endif
                                CurrentCompanion:rapportwithplayer -= Random(5, 20)
                                Ongoing = false
                                
                            Endif
                            
                        Else
                            NPCdrinks = true
                        Endif
                        
                        If NPCdrinks
                            "We had a drink together ..."
                            passTime(0.1, 0.2)
                            Player:intoxication += Random(1,15)
                            toxfactor = 100
                            toxfactor -= CurrentCompanion:fitness
                            toxfactor = toxfactor/10
                            CurrentCompanion:intoxication += Random(1,6)*toxfactor
                        Endif
                        
                    Elseif 4 // FLIRT
                        If isModEnabled(vin_NTR) && [[!CurrentCompanion.isRelative() && CurrentCompanion.hadSex() && CurrentCompanion:masochist > 95 && masochist < -25] || [CurrentCompanion.isProstitute() && CurrentCompanion.hadSex() && CurrentCompanion:masochist > masochist && isModEnabled(sb_PimpYourGirl)]]
                            If !CurrentCompanion.isProstitute() // Submissive Options
                                flirting = true
                                While flirting
                                    0:: !hadSex:: "Tell <CurrentCompanion.him_or_her> to get naked"
                                    1:: !WearsCollar:: "Tell <CurrentCompanion.him_or_her> to wear a collar"
                                    2:: !MasturbatedForYou:: "Tell <CurrentCompanion.him_or_her> to masturbate for you"
                                    3:: !GaveSpanking:: "Give <CurrentCompanion.him_or_her> a spanking"
                                    4:: !hadSex:: "Kiss <CurrentCompanion.him_or_her>"
                                    5:: "Back"
                                    
                                    If 5
                                        flirting = false
                                    Elseif 0
                                        If CurrentCompanion:masochist > 98
                                            CurrentCompanion(Flirty):: "Of course, anything that makes you happy."
                                        Elseif CurrentCompanion:masochist > 85
                                            CurrentCompanion(Flirty):: "Mhhh ..."
                                        Endif
                                        
                                        CurrentCompanion.strip()
                                        If WearsCollar
                                            CurrentCompanion.dressBondage(Bdg_Collar)
                                        Endif
                                        masochist -= Random(0, 1)
                                        CurrentCompanion:masochist += Random(0, 1)
                                        CurrentCompanion:perversion += Random(0, 0.5)
                                        
                                    Elseif 1
                                        If CurrentCompanion:masochist > 98
                                            CurrentCompanion(Flirty):: "Oh, I like that. I'll do anything you want."
                                        Elseif CurrentCompanion:masochist > 85
                                            CurrentCompanion(Flirty):: "Mmmmmhhh ..."
                                        Endif
                                        
                                        CurrentCompanion.dressBondage(Bdg_Collar)
                                        masochist -= Random(0, 2)
                                        CurrentCompanion:masochist += Random(0, 2)
                                        WearsCollar = true
                                        
                                    Elseif 2
                                        If CurrentCompanion:masochist > 98
                                            CurrentCompanion(Flirty):: "Of course, I'd love to."
                                        Elseif CurrentCompanion:masochist > 85
                                            CurrentCompanion(Flirty):: "Mmmmmmhhh ..."
                                        Endif
                                        
                                        Filter(Solo)
                                        Sex(CurrentCompanion)
                                        CurrentCompanion:perversion += Random(0, 1)
                                        masochist -= Random(0, 1)
                                        CurrentCompanion:masochist += Random(0, 1)
                                        Player.show(0)
                                        CurrentCompanion.show(2)
                                        
                                        If CurrentCompanion:masochist > 98 && CurrentCompanion:perversion > 75
                                            CurrentCompanion(Flirty):: "This pussy is at your service."
                                        Elseif CurrentCompanion:masochist < 85 && CurrentCompanion:perversion < 75
                                            CurrentCompanion(Flirty):: "Did you enjoy it?"
                                        Endif
                                        MasturbatedForYou = true
                                        
                                    Elseif 3
                                        If CurrentCompanion:masochist > 98
                                            CurrentCompanion(Flirty):: "Of course. Whatever you like."
                                        Elseif CurrentCompanion:masochist > 85
                                            CurrentCompanion(Flirty):: "Mmmmmmhhh ..."
                                        Else
                                            CurrentCompanion():: "Why? Did I do something wrong?"
                                            Player():: "..."
                                            "You give <CurrentCompanion.him_or_her> a straight look and <CurrentCompanion.he_or_she> doesn't say anything else and doesn't fight back."
                                        Endif
                                        
                                        Player.hide()
                                        CurrentCompanion.hide()
                                        "You put <CurrentCompanion.him_or_her> over your knee and gave <CurrentCompanion.him_or_her> a good spanking ..."
                                        Player.show(0)
                                        CurrentCompanion.show(2)
                                        
                                        masochist -= Random(1, 3)
                                        CurrentCompanion:masochist += Random(1, 3)
                                        
                                        If CurrentCompanion:masochist > 98 && CurrentCompanion:perversion > 75
                                            CurrentCompanion(Flirty):: "Thank you. I needed this."
                                        Elseif CurrentCompanion:masochist < 85 && CurrentCompanion:perversion < 75
                                            CurrentCompanion(Flirty):: "Ouch ... why did you do this?"
                                        Else
                                            CurrentCompanion(Happy):: "..."
                                        Endif
                                        GaveSpanking = true
                                        
                                    Elseif 4
                                        Kissed = true
                                        NPCKissed = false
                                        flirting = false
                                    Endif
                                    
                                endWhile
                            Else // Prostitute Options
                                flirting = true
                                While flirting
                                    0:: PCustomersToday > 0:: "Tell <CurrentCompanion.him_or_her> to take a shower"
                                    1:: !TrainedStrip:: "Tell <CurrentCompanion.him_or_her> to strip for you"
                                    2:: !TrainedLapdance"Tell <CurrentCompanion.him_or_her> to give you a lapdance"
                                    3:: "Beat <CurrentCompanion.him_or_her> up"
                                    4:: !hadSex:: "Kiss <CurrentCompanion.him_or_her>"
                                    5:: "Back"
                                    
                                    If 5
                                        flirting = false
                                    Elseif 0
                                        CurrentCompanion.hide()
                                        "<CurrentCompanion.name> went to the bathroom and took a shower ..."
                                        If CurrentCompanion:perversion > 75 || hadSex()
                                            CurrentCompanion.strip()
                                            "After a while <CurrentCompanion.he_or_she> came back relaxed."
                                            CurrentCompanion.show(2)
                                            arousal += 5
                                            CurrentCompanion:arousal += 5
                                        Else
                                            CurrentCompanion.show(2)
                                            "After a while <CurrentCompanion.he_or_she> came back, looking good and somewhat relaxed."
                                        Endif
                                        passTime(0.1, 0.5)
                                        PCustomersToday = 0
                                        CustomersToday.clearGlobal()
                                        MoneyToday.clearGlobal()
                                        masochist -= Random(0,1)
                                        CurrentCompanion:masochist += Random(0,1)
                                    Elseif 1
                                        CurrentCompanion.strip()
                                        CurrentCompanion.dress()
                                        Player.show(4)
                                        CurrentCompanion.show(3)
                                        "<CurrentCompanion.name> starts dancing infront of you ..."
                                        CurrentCompanion(Happy):: "Let's have some fun!"
                                        
                                        "<CurrentCompanion.name> starts taking her clothes off ..."
                                        
                                        If CurrentCompanion:attractiveness > 80
                                            "<CurrentCompanion.He_or_She> looks very sexy ..."
                                        Endif
                                        
                                        StripClothes = 0
                                        While StripClothes < 4 || !CurrentCompanion.Naked()
                                            CurrentCompanion.stripOne()
                                            CurrentCompanion():: "..."
                                            StripClothes += 1
                                        endWhile
                                        
                                        If CurrentCompanion:dance > 90
                                            "<CurrentCompanion.name> is dancing incredibly sexy. <CurrentCompanion.He_or_She> is a great dancer."
                                            arousal += 100
                                            If CurrentCompanion:totalcustomers < 20
                                                Player():: "(I should definitly take <CurrentCompanion.him_or_her> to a stripclub and let <CurrentCompanion.him_or_her> dance ...)"
                                            Endif
                                            
                                        Elseif CurrentCompanion:dance > 50
                                            "<CurrentCompanion.name> is doing a great job."
                                            arousal += 50
                                        Elseif CurrentCompanion:dance > 20
                                            "<CurrentCompanion.name> gave it their all, but doesn't really impress you."
                                            arousal += 20
                                        Elseif CurrentCompanion:attractiveness > 70
                                            "<CurrentCompanion.name> can't dance, but the sight of <CurrentCompanion.his_or_her> naked body seems to make up for it."
                                            arousal += 20
                                        Else
                                            "<CurrentCompanion.he_or_she> is trying hard but it looks kinda awkward ..."
                                            "<CurrentCompanion.name> gave it their all, but at least <CurrentCompanion.he_or_she> got a little more practice now."
                                            arousal -= 20
                                        Endif
                                        
                                        CurrentCompanion:perversion += 0.1
                                        CurrentCompanion:dance += 0.1
                                        CurrentCompanion:arousal += 20
                                        CurrentCompanion:masochist += 0.1
                                        Player.show(0)
                                        CurrentCompanion.show(2)
                                        TrainedStrip = true
                                        
                                    Elseif 2
                                        Player.show(4)
                                        CurrentCompanion.show(3)
                                        CurrentCompanion(Happy):: "Okay, I'll give you a lapdance. Let's have some fun!"
                                        
                                        "<CurrentCompanion.name> starts dancing for you ..."
                                        
                                        If CurrentCompanion:dance < 20
                                            "<CurrentCompanion.he_or_she> is trying hard but it feels kinda awkward ..."
                                            "<CurrentCompanion.name> gave it their all, but at least <CurrentCompanion.he_or_she> got a little more practice now."
                                            arousal -= 20
                                        Elseif CurrentCompanion:dance < 50
                                            "<CurrentCompanion.name> gave you a nice little lapdance."
                                            arousal += 20
                                        Elseif CurrentCompanion:dance < 90
                                            "<CurrentCompanion.name> did a great job. Now you're hot."
                                            arousal += 50
                                        Else
                                            "<CurrentCompanion.name> gave you an amazing lapdance."
                                            "You were close to squirting your pants."
                                            arousal += 100
                                            If CurrentCompanion:totalcustomers < 20
                                                Player():: "(I should definitly take <CurrentCompanion.him_or_her> to a stripclub and let <CurrentCompanion.him_or_her> dance ...)"
                                            Endif
                                            
                                        Endif
                                        
                                        CurrentCompanion:perversion += 0.1
                                        CurrentCompanion:dance += 0.1
                                        CurrentCompanion:arousal += 20
                                        CurrentCompanion:masochist += 0.1
                                        Player.show(0)
                                        CurrentCompanion.show(2)
                                        TrainedLapdance = true
                                        
                                    Elseif 3
                                        Player.show(3)
                                        CurrentCompanion(Shocked):: "NO! Please!! No! HELP!"
                                        Player(Angry):: "Oh yes!"
                                        If martial > CurrentCompanion:martial && muscle > CurrentCompanion:muscle
                                            karma -= Random(5,10)
                                            "<CurrentCompanion.name> tried to run away but had no chance ..."
                                            "You keep hitting <CurrentCompanion.him_or_her> hard. Over and over again."
                                            "<CurrentCompanion.name> is crying and screaming ... after a while <CurrentCompanion.he_or_she>'s lying on the floor weeping ..."
                                            "You are sure <CurrentCompanion.name> will be a lot more obedient from now on."
                                            If sneak < Random(0,50) && CurrentCompanion:masochist < Random(0,50)
                                                CurrentCompanion.hide()
                                                "After a few days ..."
                                                CurrentCompanion:rapportwithplayer -= Random(50,100)
                                                CurrentCompanion:attractiontoplayer -= Random(0,20)
                                                CurrentCompanion.removeProstitute()
                                                CurrentCompanion.setActorVar(tag_Whore, 0)
                                                "Knock! Knock! Police! Open the door!"
                                                "It seems that <CurrentCompanion.name> went to the police and filed a complaint."
                                                "The cops entered quickly and arrested me."
                                                endDate()
                                                sentence => 1000
                                                followUp(imprisoned)
                                            Else
                                                CurrentCompanion:rapportwithplayer -= Random(0,20)
                                                CurrentCompanion:attractiontoplayer -= Random(0,20)
                                                CurrentCompanion:attractiveness -= Random(2,15)
                                                CurrentCompanion:masochist += Random(20,60)
                                            Endif
                                            endDate()
                                            flirting = false
                                            Ongoing = false
                                        Else
                                            "You tried to hit <CurrentCompanion.name> but <CurrentCompanion.he_or_she>'s able to defend herself quite well ..."
                                            CurrentCompanion:rapportwithplayer -= Random(50,100)
                                            CurrentCompanion:attractiontoplayer -= Random(0,20)
                                            CurrentCompanion.removeProstitute()
                                            CurrentCompanion.setActorVar(tag_Whore, 0)
                                            karma -= Random(5,10)
                                            CurrentCompanion(Angry):: "You are the scum of the earth. You'll never see me again!"
                                            masochist += 2.5
                                            mood -= 100
                                            If isPlayerMarried() && CurrentCompanion.isDating()
                                                CurrentCompanion(Angry):: "Enough is enough. I don't want you in jail but I also don't have to put up with this!"
                                                Divorce()
                                                LoseDating()
                                                blockContact(CurrentCompanion)
                                                If Player.isDominantSex(CurrentCompanion) && money > 1000
                                                    "Unfortunately for me, the court awarded half of my hard-earned fortune to <CurrentCompanion.name> ... What a disaster of a marriage that was ..."
                                                    money -= money*0.5
                                                Endif
                                                endDate()
                                            Else
                                                "<CurrentCompanion.name> kicked you in the balls ... and <CurrentCompanion.he_or_she> took also a part of your money."
                                                FinalIncome = Random(100,500)
                                                money -= FinalIncome
                                                FinalIncomeConverted = FinalIncome.convertToLocalCurrency(true)
                                                If CurrentCompanion.isDating()
                                                    "You lost <FinalIncomeConverted> and your girlfriend ..."
                                                    LoseDating()
                                                Else
                                                    "You lost <FinalIncomeConverted> ... "
                                                Endif
                                                blockContact(CurrentCompanion)
                                                endDate()
                                            Endif
                                            flirting = false
                                            Ongoing = false
                                        Endif   
                                    Elseif 4
                                        Kissed = true
                                        NPCKissed = false
                                        flirting = false
                                    Endif
                                    
                                endWhile
                            Endif
                        Else // Normal Flirt
                            flirting = true
                            While flirting
                                impressed = false
                                If DebugLog
                                    CArousal = CurrentCompanion:arousal
                                    CAttraction = CurrentCompanion:attractiontoplayer
                                    CRapport = CurrentCompanion:rapportwithplayer
                                    CIntox = CurrentCompanion:intoxication
                                    CMaso = CurrentCompanion:masochist
                                    CPerv = CurrentCompanion:perversion
                                    "Companion - Arousal:<CArousal>  Attrac:<CAttraction>  Rapp:<CRapport>  Intox:<CIntox>  Maso:<CMaso>  Perv:<CPerv>"
                                    CArousal = Player:arousal
                                    CSneak = Player:sneak
                                    CInter = Player:interpersonal
                                    CIntel = Player:intelligence
                                    CMaso = Player:masochist
                                    CPerv = Player:perversion
                                    "Player - Arousal:<CArousal>  Sneak:<CSneak>  Inter:<CInter>  Intel:<CIntel>  Maso:<CMaso>  Perv:<CPerv>"
                                Endif
                                0:: !hadSex:: "Flirt subtly"
                                1:: !hadSex:: "Flirt blatantly"
                                2:: !hadSex:: "Touch <CurrentCompanion.his_or_her> thigh"
                                3:: !hadSex:: "Wrap your arm around <CurrentCompanion.him_or_her>"
                                4:: !hadSex:: "Kiss <CurrentCompanion.him_or_her>"
                                5:: "Back"
                                
                                If 5
                                    flirting = false
                                Elseif 4
                                    If CurrentCompanion.isRelative()
                                        If Random(0, 25) < CurrentCompanion:incest
                                            Kissed = true
                                            NPCKissed = false
                                            flirting = false
                                        Else
                                            CurrentCompanion(Shocked):: "What are you doing? You're my <CurrentCompanion.callplayer>!"
                                            "Oh well, at least I made my interest clear ..."
                                            CurrentCompanion():: "..."
                                            Kissed = false
                                            NPCKissed = false
                                            flirting = false
                                        Endif
                                    Else
                                        Kissed = true
                                        NPCKissed = false
                                        flirting = false
                                    Endif
                                    
                                Elseif Flirts > 5
                                    "I think that's enough flirting for now. Even if <CurrentCompanion.he_or_she>'s receptive to it, it must start to get pretty tiring for <CurrentCompanion.him_or_her> by now."
                                    impressed = false
                                    
                                Else
                                    impressed = false
                                    If CurrentCompanion:masochist > masochist && [CurrentCompanion.isDating() || CurrentCompanion.isAffair() || CurrentCompanion.isProstitute()]
                                        "<CurrentCompanion.name> seems receptive to my advances."
                                        CurrentCompanion:attractiontoplayer += Random(0, 0.25)
                                        impressed = true
                                        
                                    Elseif CurrentCompanion.isRelative() && CurrentCompanion.isInterestedIn(Player) && isModEnabled(vin_Incest) && Random(0, 100)*(choice+1) < CurrentCompanion:perversion + CurrentCompanion:incest + interpersonal
                                        "My <CurrentCompanion.relationship> seems receptive to my advances."
                                        CurrentCompanion:incest += Random(0, 0.25)
                                        impressed = true
                                        
                                    Elseif !CurrentCompanion.isRelative() && CurrentCompanion.isInterestedIn(Player) && Random(0, 100)*(choice+1) < CurrentCompanion:perversion + CurrentCompanion:attractiontoplayer + interpersonal
                                        "<CurrentCompanion.name> seems receptive to my advances."
                                        CurrentCompanion:attractiontoplayer += Random(0, 0.25)
                                        impressed = true
                                        
                                    Else
                                        If CurrentCompanion.isRelative()
                                            "My flirting fails to impress my <CurrentCompanion.relationship>."
                                            CurrentCompanion:incest -= Random(0, 0.25)
                                        Else
                                            "My flirting fails to impress <CurrentCompanion.name>."
                                            CurrentCompanion:attractiontoplayer -= Random(0, 0.25)
                                        Endif
                                        impressed = false
                                        
                                    Endif
                                    Flirts += 1
                                    
                                Endif
                                
                                If DebugLog
                                    "Flirts: <Flirts>"
                                Endif
                                
                                If [CurrentCompanion.isDating() || CurrentCompanion.isAffair() || CurrentCompanion.isProstitute()]
                                    If impressed && CurrentCompanion:masochist > 0 && Flirts > 1 && [CurrentCompanion:intoxication > 50 || CurrentCompanion:attractiontoplayer > 30]
                                        "<CurrentCompanion.name> opens slightly <CurrentCompanion.his_or_her> lips and is softly touching my neck ..."
                                        CurrentCompanion:arousal += Random(0, 5.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && Flirts > 0 && [CurrentCompanion:intoxication > 40 || CurrentCompanion:attractiontoplayer > 30]
                                        "<CurrentCompanion.name> looks deep into my eyes and opens slightly <CurrentCompanion.his_or_her> lips ..."
                                        CurrentCompanion:arousal += Random(0, 4.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && Flirts > 0 && [CurrentCompanion:intoxication > 30 || CurrentCompanion:attractiontoplayer > 30]
                                        "<CurrentCompanion.name> looks deep into my eyes and smiles at me ..."
                                        CurrentCompanion:arousal += Random(0, 3.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && Flirts > 0 && [CurrentCompanion:intoxication > 20 || CurrentCompanion:attractiontoplayer > 20]
                                        "<CurrentCompanion.name> looks deep into my eyes ..."
                                        CurrentCompanion:arousal += Random(0, 2.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && [CurrentCompanion:intoxication > 10 || CurrentCompanion:attractiontoplayer > 10]
                                        "<CurrentCompanion.name> smiles at me ..."
                                        CurrentCompanion:arousal += Random(0, 1.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && Flirts > 1 && [CurrentCompanion:intoxication > 50 || CurrentCompanion:attractiontoplayer > 30]
                                        "<CurrentCompanion.name> opens slightly <CurrentCompanion.his_or_her> lips and is softly grabbing my hair ..."
                                        CurrentCompanion:arousal += Random(0, 7.5)
                                        TryToKiss = true
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && Flirts > 0 && [CurrentCompanion:intoxication > 40 || CurrentCompanion:attractiontoplayer > 30]
                                        "<CurrentCompanion.name> looks deep into my eyes and strokes softly over my lips ..."
                                        CurrentCompanion:arousal += Random(0, 5.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && Flirts > 0 && [CurrentCompanion:intoxication > 30 || CurrentCompanion:attractiontoplayer > 30]
                                        "<CurrentCompanion.name> comes closer to me ..."
                                        CurrentCompanion:arousal += Random(0, 4.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && Flirts > 0 && [CurrentCompanion:intoxication > 20 || CurrentCompanion:attractiontoplayer > 20]
                                        "<CurrentCompanion.name> looks deep into my eyes ... and touches inadvertently softly over my crotch ..."
                                        CurrentCompanion:arousal += Random(0, 3.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && [CurrentCompanion:intoxication > 10 || CurrentCompanion:attractiontoplayer > 10]
                                        "<CurrentCompanion.name> touches my thigh ..."
                                        CurrentCompanion:arousal += Random(0, 2.5)
                                    Elseif !impressed && CurrentCompanion:masochist < -20 && CurrentCompanion:attractiontoplayer < 20
                                        CurrentCompanion(Happy):: "Why are you looking at me like this? Is something wrong?"
                                    Else
                                        "<CurrentCompanion.name> simply looks at me ..."
                                    Endif
                                Elseif CurrentCompanion.isRelative()
                                    If impressed && CurrentCompanion:masochist > 0 && Flirts > 1 && [CurrentCompanion:arousal > 40 || CurrentCompanion:intoxication > 90 || CurrentCompanion:incest > 40]
                                        "My <CurrentCompanion.relationship> opens slightly <CurrentCompanion.his_or_her> lips and is softly touching my neck ..."
                                        CurrentCompanion:arousal += Random(3, 7.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && Flirts > 0 && [CurrentCompanion:arousal > 30 || CurrentCompanion:intoxication > 70 || CurrentCompanion:incest > 30]
                                        "My <CurrentCompanion.relationship> looks deep into my eyes and opens slightly <CurrentCompanion.his_or_her> lips ..."
                                        CurrentCompanion:arousal += Random(2, 6.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && Flirts > 0 && [CurrentCompanion:arousal > 15 || CurrentCompanion:intoxication > 50 || CurrentCompanion:incest > 20]
                                        "My <CurrentCompanion.relationship> looks deep into my eyes and smiles at me ..."
                                        CurrentCompanion:arousal += Random(2, 5.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && Flirts > 0 && [CurrentCompanion:arousal > 10 || CurrentCompanion:intoxication > 30 || CurrentCompanion:incest > 10]
                                        "My <CurrentCompanion.relationship> looks deep into my eyes ..."
                                        CurrentCompanion:arousal += Random(1, 4.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && [CurrentCompanion:arousal > 5 || CurrentCompanion:intoxication > 10 || CurrentCompanion:incest > 10]
                                        "My <CurrentCompanion.relationship> smiles at me ..."
                                        CurrentCompanion:arousal += Random(1, 3.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && Flirts > 1 && [CurrentCompanion:arousal > 40 || CurrentCompanion:intoxication > 90 || CurrentCompanion:incest > 40]
                                        "My <CurrentCompanion.relationship> opens slightly <CurrentCompanion.his_or_her> lips and is softly grabbing my hair ..."
                                        CurrentCompanion:arousal += Random(1, 7.5)
                                        NPCKissed = true
                                        Kissed = true
                                        flirting = false
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && Flirts > 0 && [CurrentCompanion:arousal > 30 || CurrentCompanion:intoxication > 70 || CurrentCompanion:incest > 30]
                                        "My <CurrentCompanion.relationship> looks deep into my eyes and strokes softly over my lips ..."
                                        CurrentCompanion:arousal += Random(1, 5.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && Flirts > 0 && [CurrentCompanion:arousal > 15 || CurrentCompanion:intoxication > 50 || CurrentCompanion:incest > 20]
                                        "My <CurrentCompanion.relationship> comes closer to me ..."
                                        CurrentCompanion:arousal += Random(1, 4.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && Flirts > 0 && [CurrentCompanion:arousal > 10 || CurrentCompanion:intoxication > 30 || CurrentCompanion:incest > 10]
                                        "My <CurrentCompanion.relationship> looks deep into my eyes ... and touches inadvertently softly over my crotch ..."
                                        CurrentCompanion:arousal += Random(1, 3.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && [CurrentCompanion:arousal > 5 || CurrentCompanion:intoxication > 10 || CurrentCompanion:incest > 10]
                                        "My <CurrentCompanion.relationship> touches my thigh ..."
                                        CurrentCompanion:arousal += Random(1, 2.5)
                                    Elseif impressed && !CurrentCompanion.hadSex() && CurrentCompanion:masochist < 0
                                        CurrentCompanion(Happy):: "Why are you looking at me like this? Is something wrong?"
                                    Elseif flirting
                                        "My <CurrentCompanion.relationship> looks at me ..."
                                    Endif
                                Elseif !CurrentCompanion.isRelative()
                                    If impressed && CurrentCompanion:masochist > 0 && [CurrentCompanion:arousal > 40 || CurrentCompanion:intoxication > 90 || Random(90, 90) < CurrentCompanion:attractiontoplayer] && Flirts > 1
                                        "<CurrentCompanion.name> opens slightly <CurrentCompanion.his_or_her> lips and is softly touching my neck ..."
                                        CurrentCompanion:arousal += Random(3, 7.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && [CurrentCompanion:arousal > 30 || CurrentCompanion:intoxication > 70 || Random(70, 90) < CurrentCompanion:attractiontoplayer] && Flirts > 0
                                        "<CurrentCompanion.name> looks deep into my eyes and opens slightly <CurrentCompanion.his_or_her> lips ..."
                                        CurrentCompanion:arousal += Random(2, 6.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && [CurrentCompanion:arousal > 15 || CurrentCompanion:intoxication > 50 || Random(50, 90) < CurrentCompanion:attractiontoplayer] && Flirts > 0
                                        "<CurrentCompanion.name> looks deep into my eyes and smiles at me ..."
                                        CurrentCompanion:arousal += Random(2, 5.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && [CurrentCompanion:arousal > 10 || CurrentCompanion:intoxication > 30 || Random(30, 90) < CurrentCompanion:attractiontoplayer] && Flirts > 0
                                        "<CurrentCompanion.name> looks deep into my eyes ..."
                                        CurrentCompanion:arousal += Random(1, 4.5)
                                    Elseif impressed && CurrentCompanion:masochist > 0 && [CurrentCompanion:arousal > 5 || CurrentCompanion:intoxication > 10 || Random(10, 90) < CurrentCompanion:attractiontoplayer]
                                        "<CurrentCompanion.name> smiles at me ..."
                                        CurrentCompanion:arousal += Random(1, 3.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && [CurrentCompanion:arousal > 40 || CurrentCompanion:intoxication > 90 || Random(90, 100) < CurrentCompanion:attractiontoplayer] && Flirts > 1
                                        "<CurrentCompanion.name> opens slightly <CurrentCompanion.his_or_her> lips and is softly grabbing my hair ..."
                                        CurrentCompanion:arousal += Random(1, 7.5)
                                        NPCKissed = true
                                        Kissed = true
                                        flirting = false
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && [CurrentCompanion:arousal > 30 || CurrentCompanion:intoxication > 70 || Random(70, 100) < CurrentCompanion:attractiontoplayer] && Flirts > 0
                                        "<CurrentCompanion.name> looks deep into my eyes and strokes softly over my lips ..."
                                        CurrentCompanion:arousal += Random(1, 5.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && [CurrentCompanion:arousal > 15 || CurrentCompanion:intoxication > 50 || Random(50, 100) < CurrentCompanion:attractiontoplayer] && Flirts > 0
                                        "<CurrentCompanion.name> comes closer to me ..."
                                        CurrentCompanion:arousal += Random(1, 4.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && [CurrentCompanion:arousal > 10 || CurrentCompanion:intoxication > 30 || Random(30, 100) < CurrentCompanion:attractiontoplayer] && Flirts > 0
                                        "<CurrentCompanion.name> looks deep into my eyes ... and touches inadvertently softly over my crotch ..."
                                        CurrentCompanion:arousal += Random(1, 3.5)
                                    Elseif impressed && CurrentCompanion:masochist < 0 && CurrentCompanion:masochist > masochist && [CurrentCompanion:arousal > 5 || CurrentCompanion:intoxication > 10 || Random(10, 100) < CurrentCompanion:attractiontoplayer] && Flirts > 0
                                        "<CurrentCompanion.name> touches my thigh ..."
                                        CurrentCompanion:arousal += Random(1, 2.5)
                                    Elseif impressed && !CurrentCompanion.hadSex() && CurrentCompanion:masochist < 0 && CurrentCompanion:intoxication < 90 && Random(0, 30) > CurrentCompanion:attractiontoplayer
                                        CurrentCompanion(Happy):: "Why are you looking at me like this? Is something wrong?"
                                    Elseif flirting
                                        "<CurrentCompanion.name> looks at me ..."
                                    Endif
                                    
                                    If !CurrentCompanion.isRelative() && !CurrentCompanion.isMale() && Random(50,200) < CurrentCompanion:intoxication+CurrentCompanion:arousal
                                        NPCKissed = true
                                        Kissed = true
                                        flirting = false
                                    Elseif !CurrentCompanion.isRelative() && CurrentCompanion.isMale() && Random(0,100) < CurrentCompanion:intoxication+CurrentCompanion:arousal
                                        NPCKissed = true
                                        Kissed = true
                                        flirting = false
                                    Endif
                                Endif
                            endWhile
                        Endif
                        
                    Endif

                    If ThankYouSex
                        Kissed = true
                        NPCKissed = true
                        ThankYouSex = false
                    Endif
                        
                    // NPC KISS
                    If !TryedKissing && !Kissed && !Payed && !NPCKissed && CurrentCompanion.isInterestedIn(Player) && !hadSex && CurrentCompanion:attractiontoplayer+CurrentCompanion:arousal > Random(180, 200) && !UsedRapeDrug
                        Kissed = true
                        NPCKissed = true
                    Endif
                    
                    // NTR PART
                    If Kissed && isModEnabled(sb_PimpYourGirl) && masochist < 75 && !UsedRapeDrug && CurrentCompanion.isProstitute()
                        If PCustomersToday > 12 && CurrentCompanion:perversion > 85 && CurrentCompanion:masochist < -75
                            If NPCKissed
                                If CurrentCompanion.isRelative()
                                    "My <CurrentCompanion.relationship> leans over to me and touches my chest ... "
                                Else
                                    "<CurrentCompanion.name> leans over to me and touches my chest ... "
                                Endif
                                CurrentCompanion(Flirty):: "I really would like to kiss you now ... but ..."
                            Else
                                "<CurrentCompanion.name> touches your chest ... realizing what you're about to do ..."
                                CurrentCompanion(Flirty):: "To be honest ..." 
                            Endif
                            CurrentCompanion(Flirty):: "I will kiss you, but first you have to lick all that cum from my face ..."
                            If !CurrentCompanion.isDating()
                                CurrentCompanion(Flirty):: "It makes me so horny when you do it ..."
                                CurrentCompanion:arousal += 50
                            Elseif CurrentCompanion.isDating()
                                CurrentCompanion(Flirty):: "I'm your cheap and filthy whore ... lick it all up ... and then maybe, maybe you'll get your sloppy seconds ..."
                                CurrentCompanion:arousal += 50
                            Endif
                            0:: "Lick it"
                            1:: "Oh wait ... that's disgusting"
                            
                            If 0
                                CurrentCompanion(Flirty):: "Oh yes ... lick it all up ... slowly ... mmmmmmh ... good boy!"
                                CurrentCompanion(Flirty):: "Now you can kiss me ..."
                                CurrentCompanion:masochist -= Random(0,5)
                                masochist += Random(0,5)
                                CurrentCompanion:perversion -= Random(0,5)
                                perversion += Random(0,3)
                            Else
                                Kissed = false
                                CurrentCompanion:masochist += Random(0,1)
                                masochist -= Random(0,1)
                            Endif
                        Elseif PCustomersToday > 12 && CurrentCompanion:perversion > 85
                            If NPCKissed
                                If CurrentCompanion.isRelative()
                                    "My <CurrentCompanion.relationship> leans over to me and touches my chest ... "
                                Else
                                    "<CurrentCompanion.name> leans over to me and touches my chest ... "
                                Endif
                                CurrentCompanion(Flirty):: "I really would like to kiss you now ... "
                            Else
                                "<CurrentCompanion.name> touches your chest ... realizing what you're about to do ..."
                                CurrentCompanion(Flirty):: "To be honest ..." 
                            Endif
                            CurrentCompanion(Flirty):: "I love it when you kiss me with all that cum on my face ..."
                            If CurrentCompanion:masochist > 50 || CurrentCompanion:perversion > 95
                                CurrentCompanion(Flirty):: "It makes me so horny ..."
                                CurrentCompanion:arousal += 50
                            Elseif CurrentCompanion.isDating() && CurrentCompanion:masochist > 0
                                CurrentCompanion(Flirty):: "I'm your cheap and filthy whore ... kiss me ... make love to me ..."
                                CurrentCompanion:arousal += 50
                            Endif
                            0:: "Kiss <CurrentCompanion.him_or_her>"
                            1:: "Oh wait ... that's disgusting"
                            
                            If 0
                                CurrentCompanion:masochist -= Random(0,3)
                                masochist += Random(0,3)
                                CurrentCompanion:perversion -= Random(0,3)
                                perversion += Random(0,3)
                            Else
                                Kissed = false
                                CurrentCompanion:masochist += Random(0,1)
                                masochist -= Random(0,1)
                            Endif
                        Elseif PCustomersToday > 0 && CurrentCompanion:perversion > 85
                            If NPCKissed
                                If CurrentCompanion.isRelative()
                                    "My <CurrentCompanion.relationship> leans over to me and touches my chest ... "
                                Else
                                    "<CurrentCompanion.name> leans over to me and touches my chest ... "
                                Endif
                                CurrentCompanion(Flirty):: "I really would like to kiss you now ... "
                            Else
                                "<CurrentCompanion.name> touches your chest ... realizing what you're about to do ..."
                                CurrentCompanion(Flirty):: "To be honest ..." 
                            Endif
                            CurrentCompanion(Flirty):: "I really like it when you want me after I had sex with someone else ..."
                            If PCustomersToday > 5 && CurrentCompanion.isFemale()
                                CurrentCompanion(Flirty):: "Don't forget I gave at least five blowjobs today ... and a few of them came in my mouth too ...  do you really want to kiss these lips?"
                            Endif
                            0:: "Kiss <CurrentCompanion.him_or_her>"
                            1:: "Oh wait ... that's disgusting"
                            
                            If 0
                                CurrentCompanion:masochist -= Random(0,3)
                                masochist += Random(0,3)
                                CurrentCompanion:perversion -= Random(0,3)
                                perversion += Random(0,3)
                            Else
                                Kissed = false
                            Endif
                        Elseif PCustomersToday > 12 && CurrentCompanion:perversion > 55
                            If NPCKissed
                                If CurrentCompanion.isRelative()
                                    "My <CurrentCompanion.relationship> leans over to me and touches my chest ... "
                                Else
                                    "<CurrentCompanion.name> leans over to me and touches my chest ... "
                                Endif
                                CurrentCompanion(Flirty):: "I really would like to kiss you now ... would it be okay for you to kiss me with all that cum on my face?"
                            Else
                                "<CurrentCompanion.name> touches your chest ... realizing what you're about to do ..."
                                CurrentCompanion(Flirty):: "Are you really sure you want to kiss me with all that cum on my face?"
                            Endif
                            
                            0:: "Yes"
                            1:: "Oh wait ... that's disgusting"
                            
                            If 0
                                CurrentCompanion:masochist -= Random(0,3)
                                masochist += Random(0,3)
                                CurrentCompanion:perversion -= Random(0,3)
                                perversion += Random(0,3)
                            Else
                                Kissed = false
                            Endif
                        Elseif PCustomersToday > 1 && CurrentCompanion:perversion > 55
                            If NPCKissed
                                If CurrentCompanion.isRelative()
                                    "My <CurrentCompanion.relationship> leans over to me and touches my chest ... "
                                Else
                                    "<CurrentCompanion.name> leans over to me and touches my chest ... "
                                Endif
                                CurrentCompanion(Flirty):: "I really would like to kiss you now ... would it be okay for you to kiss me after I had sex with <PCustomersToday> guys?"
                            Else
                                "<CurrentCompanion.name> touches your chest ... realizing what you're about to do ..."
                                CurrentCompanion(Flirty):: "Are you really sure you want to kiss me after I had sex with <PCustomersToday> guys?"
                            Endif
                            
                            0:: "Yes"
                            1:: "Oh wait ... that's disgusting"
                            
                            If 0
                                CurrentCompanion:masochist -= Random(0,2)
                                masochist += Random(0,2)
                                CurrentCompanion:perversion -= Random(0,2)
                                perversion += Random(0,2)
                            Else
                                Kissed = false
                            Endif
                        Elseif PCustomersToday > 0 && CurrentCompanion:perversion > 35
                            If NPCKissed
                                If CurrentCompanion.isRelative()
                                    "My <CurrentCompanion.relationship> leans over to me and touches my chest ... "
                                Else
                                    "<CurrentCompanion.name> leans over to me and touches my chest ... "
                                Endif
                                CurrentCompanion(Flirty):: "I really would like to kiss you now ... would it be okay for you to kiss me after I had sex with someone else?"
                            Else
                                "<CurrentCompanion.name> touches your chest ... realizing what you're about to do ..."
                                CurrentCompanion(Flirty):: "Are you really sure you want to kiss me after I had sex with someone else?"
                            Endif
                            
                            0:: "Yes"
                            1:: "Oh wait ... that's disgusting"
                            
                            If 0
                                CurrentCompanion:masochist -= Random(0,1)
                                masochist += Random(0,1)
                                CurrentCompanion:perversion -= Random(0,1)
                                perversion += Random(0,1)
                            Else
                                Kissed = false
                            Endif
                        Elseif PCustomersToday > 0
                            If NPCKissed
                                If CurrentCompanion.isRelative()
                                    "My <CurrentCompanion.relationship> leans over to me and touches my chest ... "
                                Else
                                    "<CurrentCompanion.name> leans over to me and touches my chest ... "
                                Endif
                                CurrentCompanion(Flirty):: "I really would like to kiss you now ... would it be okay for you to kiss me after I slept with someone else?"
                            Else
                                "<CurrentCompanion.name> touches your chest ... realizing what you're about to do ..."
                                CurrentCompanion(Worry):: "Are you really sure you want to kiss me after I slept with someone else?"
                            Endif
                            
                            0:: "Yes"
                            1:: "Oh wait ... that's disgusting"
                            
                            If 0
                                CurrentCompanion:masochist -= Random(0,1)
                                masochist += Random(0,1)
                                CurrentCompanion:perversion -= Random(0,1)
                                perversion += Random(0,1)
                            Else
                                Kissed = false
                            Endif
                        Endif
                    Endif
                    
                    // PROSTITUTE PAYMENT
                    If Kissed && isModEnabled(sb_PimpYourGirl) && [masochist > 75 || CurrentCompanion:masochist < -75] && masochist > CurrentCompanion:masochist && CurrentCompanion.isProstitute() && !UsedRapeDrug
                            If NPCKissed
                                If CurrentCompanion.isRelative()
                                    "Suddenly, my <CurrentCompanion.relationship> leans over to me and starts kissing me ..."
                                Else
                                    "Suddenly, <CurrentCompanion.name> leans over to me and starts kissing me ..."
                                Endif
                                TryedKissing = true
                            Endif
                            If PCustomersToday == 0 || !isModEnabled(vin_NTR) || CurrentCompanion:perversion < 85
                                Player(Kiss):: "..."
                                CurrentCompanion(Kiss):: "..."
                                "We kissed. It started slow but soon became more passionate."
                                "Suddenly <CurrentCompanion.name> smiles at you ..."
                                If CurrentCompanion.isDating()
                                    CurrentCompanion(Flirty):: "Oh, you know what? I think you should pay me."
                                Else
                                    CurrentCompanion(Flirty):: "You know you have to pay me."
                                Endif
                                SpecialPrice1 = Random(300, 450)+(CurrentCompanion:attractiveness+CurrentCompanion:pornfame+CurrentCompanion:arousal)-CurrentCompanion:attractiontoplayer
                                If SpecialPrice1 < 80
                                    SpecialPrice1 = Random(79, 117)
                                Endif
                                SpecialPrice2 = SpecialPrice1/2
                                SpecialPrice1Converted = SpecialPrice1.convertToLocalCurrency(true)
                                SpecialPrice2Converted = SpecialPrice2.convertToLocalCurrency(true)
                                If isPlayerMarried() && CurrentCompanion.isDating()
                                    CurrentCompanion(Flirty):: "As my <Player.husband_or_wife> I'll give you a special price ... only <SpecialPrice2Converted>"
                                Elseif CurrentCompanion.isDating()
                                    CurrentCompanion(Flirty):: "As my <Player.boyfriend_or_girlfriend> I'll give you a special price ... only <SpecialPrice2Converted>"
                                Elseif CurrentCompanion.isRelative()
                                    CurrentCompanion(Flirty):: "As my <CurrentCompanion.callPlayer> I'll give you a special price ... only <SpecialPrice2Converted>"
                                Else
                                    CurrentCompanion(Flirty):: "I'll give you a special price ... only <SpecialPrice2Converted>"
                                Endif
                                0:: "Pay <CurrentCompanion.him_or_her> (<SpecialPrice2Converted>)"
                                1:: "Give <CurrentCompanion.him_or_her> something extra (<SpecialPrice1Converted>)"
                                2:: "No thanks"
                                
                                If 0
                                    money -= SpecialPrice2
                                    "You payed <SpecialPrice2Converted>."
                                    Payed = true
                                    CurrentCompanion:masochist -= Random(0,1)
                                    masochist += Random(0,1)
                                    CurrentCompanion:perversion += Random(0,1)
                                    perversion += Random(0,1)
                                    CurrentCompanion:attractiontoplayer -= Random(0, 2)
                                    CurrentCompanion:rapportwithplayer += Random(0, 2)
                                Elseif 1
                                    CurrentCompanion(Flirty):: "Oh ... thank you ... you are a good little <Player.boy_or_girl>!"
                                    CurrentCompanion(Flirty):: "Or do you want to make sure I'm nice to you? Hahaha"
                                    money -= SpecialPrice1
                                    "You payed <SpecialPrice1Converted>."
                                    Payed = true
                                    CurrentCompanion:masochist -= Random(0,1)
                                    masochist += Random(0,1)
                                    CurrentCompanion:perversion += Random(0,1)
                                    perversion += Random(0,1)
                                    CurrentCompanion:attractiontoplayer -= Random(0, 2)
                                    CurrentCompanion:rapportwithplayer += Random(0, 2)
                                Else
                                    Payed = false
                                    Kissed = false
                                    NPCKissed = false
                                    CurrentCompanion:attractiontoplayer += Random(0, 2)
                                    CurrentCompanion:rapportwithplayer -= Random(0, 2)
                                    CurrentCompanion:masochist += Random(0,1)
                                    masochist -= Random(0,1)
                                Endif
                            Elseif CurrentCompanion.isFemale() && isModEnabled(vin_NTR)
                                If CurrentCompanion:masochist < -75
                                    Player(Kiss):: "..."
                                    CurrentCompanion(Kiss):: "..."
                                    If PCustomersToday > 12 && CurrentCompanion:perversion > 85 && CurrentCompanion:masochist > -75 && CurrentCompanion.isFemale()
                                        CurrentCompanion(Flirty):: "This is so filthy ... "
                                        If CurrentCompanion.isRelative()
                                            CurrentCompanion(Flirty):: "Kissing my own <CurrentCompanion.callPlayer> ... and feeling the cum from all this other men slowly dripping out of my pussy ... "
                                            CurrentCompanion(Flirty):: "Kiss me ... take me ... make love to your <CurrentCompanion.relationship>, she's a filthy whore ..."
                                        Else CurrentCompanion.isDating()
                                            CurrentCompanion(Flirty):: "Kissing my <Player.boyfriend_or_girlfriend> ... and feeling the cum from all this other men slowly dripping out of my pussy ... "
                                            CurrentCompanion(Flirty):: "Kiss me ... take me ... make love to your filthy whore ..."
                                        Else
                                            CurrentCompanion(Flirty):: "Kissing you ... and feeling the cum from all this other men slowly dripping out of my pussy ... "
                                            CurrentCompanion(Flirty):: "Kiss me ... take me ... make love to this whore ..."
                                        Endif
                                    Elseif Dating || CurrentCompanion.hadSex() || CurrentCompanion:perversion > 50 || Payed
                                        "We kissed. It started slow but soon became more passionate. It was obvious what we both wanted ..."
                                    Elseif CurrentCompanion.isRelative()
                                        "Despite the forbidden nature of it all, my <CurrentCompanion.relationship> kissed me passionately."
                                    Else
                                        "We kissed. It started slow but soon became more passionate."
                                    Endif
                                    If PCustomersToday > 0
                                        "<CurrentCompanion.His_or_Her> lips had a slightly salty taste ... strangely earthy, dense and somehow different ..."
                                    Endif
                                    If CurrentCompanion.isRelative()
                                        "Suddenly your <CurrentCompanion.relationship> smiles brightly at you ... "
                                    Else
                                        "Suddenly <CurrentCompanion.name> smiles brightly at you ... "
                                    Endif
                                    CurrentCompanion(Flirty):: "When I think about it, I think you should pay me. After all, I am a whore ... or you can lick all that cum out of me for free ... your choice."
                                    SpecialPrice1 = Random(300, 450)+(CurrentCompanion:attractiveness+CurrentCompanion:pornfame+CurrentCompanion:arousal)-CurrentCompanion:attractiontoplayer-CurrentCompanion:incest
                                    If SpecialPrice1 < 80
                                        SpecialPrice1 = Random(79, 117)
                                    Endif
                                    SpecialPrice2 = SpecialPrice1/2
                                    SpecialPrice1Converted = SpecialPrice1.convertToLocalCurrency(true)
                                    SpecialPrice2Converted = SpecialPrice2.convertToLocalCurrency(true)
                                    If isPlayerMarried() && CurrentCompanion.isDating()
                                        CurrentCompanion(Flirty):: "As my <Player.husband_or_wife> I'll give you a special price ... only <SpecialPrice2Converted>"
                                    Elseif CurrentCompanion.isDating()
                                        CurrentCompanion(Flirty):: "As my <Player.boyfriend_or_girlfriend> I'll give you a special price ... only <SpecialPrice2Converted>"
                                    Elseif CurrentCompanion.isRelative()
                                        CurrentCompanion(Flirty):: "As my <CurrentCompanion.callPlayer> I'll give you a special price ... only <SpecialPrice2Converted>"
                                    Else
                                        CurrentCompanion(Flirty):: "I'll give you a special price ... only <SpecialPrice2Converted>"
                                    Endif
                                    0:: "Pay <CurrentCompanion.him_or_her> (<SpecialPrice2Converted>)"
                                    1:: "Give <CurrentCompanion.him_or_her> something extra (<SpecialPrice1Converted>)"
                                    2:: "I want to lick her out!"
                                    3:: "No thanks"
                                    
                                    If 0
                                        money -= SpecialPrice2
                                        "You payed <SpecialPrice2Converted>."
                                        Payed = true
                                        CurrentCompanion:masochist -= Random(0,1)
                                        masochist += Random(0,1)
                                        CurrentCompanion:perversion += Random(0,1)
                                        perversion += Random(0,1)
                                        If CurrentCompanion.isRelative()
                                            CurrentCompanion:incest -= Random(0, 2)
                                        Else
                                            CurrentCompanion:attractiontoplayer -= Random(0, 2)
                                        Endif
                                        CurrentCompanion:rapportwithplayer += Random(0, 2)
                                    Elseif 1
                                        CurrentCompanion(Flirty):: "Oh ... thank you ... you are a good little <Player.boy_or_girl>!"
                                        CurrentCompanion(Flirty):: "Or do you want to make sure I'm nice to you? Hahaha"
                                        money -= SpecialPrice1
                                        "You payed <SpecialPrice1Converted>."
                                        Payed = true
                                        CurrentCompanion:masochist -= Random(0,1)
                                        masochist += Random(0,1)
                                        CurrentCompanion:perversion += Random(0,1)
                                        perversion += Random(0,1)
                                        If CurrentCompanion.isRelative()
                                            CurrentCompanion:incest -= Random(0, 2)
                                        Else
                                            CurrentCompanion:attractiontoplayer -= Random(0, 2)
                                        Endif
                                        CurrentCompanion:rapportwithplayer += Random(0, 2)
                                    Elseif 2
                                        CurrentCompanion(Flirty):: "Oh ... you are such a dirty little <Player.boy_or_girl>!"
                                        money -= SpecialPrice1
                                        Payed = false
                                        LickNTR = true
                                        CurrentCompanion:masochist -= Random(0,3)
                                        masochist += Random(0,3)
                                        CurrentCompanion:perversion += Random(0,3)
                                        perversion += Random(0,3)
                                        If CurrentCompanion.isRelative()
                                            CurrentCompanion:incest -= Random(0, 3)
                                        Else
                                            CurrentCompanion:attractiontoplayer -= Random(0, 3)
                                        Endif
                                        CurrentCompanion:rapportwithplayer += Random(0, 2)
                                    Else
                                        Payed = false
                                        Kissed = false
                                        NPCKissed = false
                                        If CurrentCompanion.isRelative()
                                            CurrentCompanion:incest += Random(0, 3)
                                        Else
                                            CurrentCompanion:attractiontoplayer += Random(0, 3)
                                        Endif
                                        CurrentCompanion:rapportwithplayer -= Random(0, 2)
                                        CurrentCompanion:masochist += Random(0,3)
                                        masochist -= Random(0,3)
                                    Endif
                                Endif
                            Endif
                    Endif
                    
                    // SEX
                    If Kissed
                        If !Payed && !LickNTR && NPCKissed
                            "Suddenly, <CurrentCompanion.name> leans over to me and starts kissing me ..."
                            TryedKissing = true
                            NPCKissed = false
                        Endif
                        If !Payed && !LickNTR
                            Player(Kiss):: "..."
                            CurrentCompanion(Kiss):: "..."
                            If PCustomersToday > 0
                                "<CurrentCompanion.His_or_Her> lips had a slightly salty taste ... strangely earthy, dense and somehow different ..."
                            Endif
                            If PCustomersToday > 12 && CurrentCompanion:perversion > 85 && CurrentCompanion:masochist > -75 && CurrentCompanion.isFemale()
                                CurrentCompanion(Flirty):: "This is so filthy ... "
                                CurrentCompanion(Flirty):: "Kissing you ... and feeling the cum from all this other men slowly dripping out of my pussy ... "
                                CurrentCompanion(Flirty):: "Kiss me ... take me ... make love to this whore ..."
                            Elseif Dating || CurrentCompanion.hadSex() || CurrentCompanion:perversion > 50 || Payed
                                "We kissed. It started slow but soon became more passionate. It was obvious what we both wanted ..."
                            Elseif CurrentCompanion.isRelative() && CurrentCompanion:incest > 95 && CurrentCompanion:perversion > 95
                                CurrentCompanion(Flirty):: "I want you <CurrentCompanion.callplayer>! I want you so much. Give it to your <CurrentCompanion.relationship>!"
                                If CurrentCompanion.isFemale() && Player.isMale() && !CurrentCompanion.isTrans()
                                    CurrentCompanion(Flirty):: "Let me feel my <CurrentCompanion.callplayer>'s cock inside my pussy!"
                                Elseif CurrentCompanion.isMale() && Player.isFemale()
                                    CurrentCompanion(Flirty):: "Let me feel my <CurrentCompanion.relationship>'s hard cock inside me!"
                                Elseif CurrentCompanion.isTrans() && !Player.isMale() && !Player.isTrans()
                                    CurrentCompanion(Flirty):: "Let me fill my <CurrentCompanion.relationship>'s pussy!"
                                Elseif CurrentCompanion.isTrans() && Player.isFemale()
                                    CurrentCompanion(Flirty):: "Let me feel my <CurrentCompanion.relationship>'s hard cock inside me!"
                                Endif
                            Elseif CurrentCompanion.isRelative() && CurrentCompanion:incest > 80 && CurrentCompanion:perversion > 60 && CurrentCompanion.hadSex()
                                "My <CurrentCompanion.relationship> kissed me passionately."
                                CurrentCompanion(Kiss):: "I want you <CurrentCompanion.callplayer>! I want you so much."
                            Elseif CurrentCompanion.isRelative() 
                                "Despite the forbidden nature of it all, my <CurrentCompanion.relationship> kissed me, <CurrentCompanion.his_or_her> own <CurrentCompanion.callplayer>."
                                "An awkward kiss at first, but soon moving towards a more passionate direction."
                            Else
                                "We had a kiss, an awkward one at first, but soon moving towards a more passionate direction."
                            Endif
                        Endif
                        If !Payed && !LickNTR
                            If CurrentCompanion.isRelative() && !CurrentCompanion.hadSex()
                                "But maybe we should stop ... this is so wrong ..."
                                "Yet it feels so right!"
                            Endif
                            "Should I let this escalate further?"
                            0:: Vanilla:: "Make out"
                            1:: "Stop"
                            
                            If 1 && CurrentCompanion:masochist < -25 && masochist > 25 && CurrentCompanion:masochist < masochist
                                CurrentCompanion(Happy):: "Oh ... don't stop ..."
                                choice = 0
                            Endif
                        Elseif !hadSex
                            choice = 0
                        Endif
                        
                        If 0
                            If !CurrentCompanion.hadSex() && CurrentCompanion.isRelative() && Random(30, 100) > CurrentCompanion:incest
                                CurrentCompanion(Embarassed):: "No, no, we should stop. This is so wrong. I'm sorry!"
                                "And just like that, my <CurrentCompanion.relationship> stopped making out, we  looked at each other briefly all blushed then without saying a word ..."
                                "Oh well, at least we both made our interests clear ..."
                                CurrentCompanion.closeEyes(false)
                                Player.closeEyes(false)
                            Elseif Payed || LickNTR || CurrentCompanion.isDating() || CurrentCompanion.isRelative() || [CurrentCompanion.isInterestedIn(Player) && [CurrentCompanion.IsDominantSex(Player) || CurrentCompanion:attractiontoplayer + CurrentCompanion:perversion > Random(50, 200) || CurrentCompanion:intoxication > 80]]
                                If PCustomersToday == 0
                                    "Our kiss got more and more steamy and soon we were making out, our hands all over each other."
                                Elseif PCustomersToday > 12
                                    If CurrentCompanion.isRelative()
                                        "The clearly visible cum stains on my <CurrentCompanion.relationship>'s face and <CurrentCompanion.his_or_her> body and the thought that my <CurrentCompanion.relationship> had already satisfied so many men made me incredibly horny ..."
                                    Else
                                        "The clearly visible cum stains on <CurrentCompanion.his_or_her> face and <CurrentCompanion.his_or_her> body and the thought that <CurrentCompanion.he_or_she> had already satisfied so many men made me incredibly horny ..."
                                    Endif
                                Elseif PCustomersToday > 0
                                    If CurrentCompanion.isRelative()
                                        "The thought of my <CurrentCompanion.relationship>'s body already being used turned me on incredibly ..."
                                    Else
                                        "The thought of <CurrentCompanion.his_or_her> body already being used turned me on incredibly ..."
                                    Endif
                                Endif
                                If TfGame() && CurrentCompanion.isMale()
                                    "I'm a man trapped inside a woman's body. I don't think I'm gay, but here I am, about to hook up with my male date."
                                Endif
                                hadSex = true
                                Player.strip()
                                CurrentCompanion.strip()
                                If CanBeSurprised && Random(0,100) > 75 && [CurrentCompanion.hasRelationship(Dating, Spouses) && Random(0,120) > CurrentCompanion:sneak && Random(0,120) > CurrentCompanion:intelligence] && [hadSex || Kissed || Flirts > 1] && CurrentCompanion:attractiontoplayer > 50
                                    CustomersToday.clearGlobal()
                                    MoneyToday.clearGlobal()
                                    followUp(goodbye_incoming_spouse)
                                    NextScene = true
                                Elseif !CurrentCompanion.isRelative() && CanBeSurprised && Random(0,100) > 75 && [CurrentCompanion.hasRelationship(ParentChild) && Random(0,120) > CurrentCompanion:sneak && Random(0,120) > CurrentCompanion:intelligence] && [hadSex || Kissed || Flirts > 1]
                                    CustomersToday.clearGlobal()
                                    MoneyToday.clearGlobal()
                                    followUp(goodbye_incoming_relative)
                                    NextScene = true
                                Else
                                    Player:perversion += Random(0, 1)
                                    If Payed
                                        If PCustomersToday > 0
                                            FilterTalk(sb_NTR_others_sex)
                                        Endif
                                        SexNoAffair(Player, CurrentCompanion)
                                        If CurrentCompanion.isProstitute() && !CurrentCompanion.isDating() && !CurrentCompanion.LivesWithPlayer()
                                            setBackground3D(Modules/sb_PimpYourGirl/Bedrooms/Prostitute02.lpworld)
                                        Else
                                            setBackground(home)
                                        Endif
                                        Payed = false
                                    Elseif LickNTR
                                        FilterTalk(sb_NTR_others_cum_licking)
                                        Filter(Licking)
                                        Sex(Player, CurrentCompanion)
                                        If CurrentCompanion.isProstitute() && !CurrentCompanion.isDating() && !CurrentCompanion.LivesWithPlayer()
                                            setBackground3D(Modules/sb_PimpYourGirl/Bedrooms/Prostitute02.lpworld)
                                        Else
                                            setBackground(home)
                                        Endif
                                        LickNTR = false
                                    Else
                                        Sex(Player, CurrentCompanion)
                                        If CurrentCompanion.isProstitute() && !CurrentCompanion.isDating() && !CurrentCompanion.LivesWithPlayer()
                                            setBackground3D(Modules/sb_PimpYourGirl/Bedrooms/Prostitute02.lpworld)
                                        Else
                                            setBackground(home)
                                        Endif
                                    Endif
                                    If CurrentCompanion.isRelative()
                                        CurrentCompanion:incest += Random(0, 40)
                                    Endif
                                    Player.strip()
                                    CurrentCompanion.strip()
                                    If WearsCollar
                                        CurrentCompanion.dressBondage(Bdg_Collar)
                                    Endif
                                    BHadAlreadySexBeforeCatch += 100
                                    HadAlreadySexBeforeCatch.setGlobal(BHadAlreadySexBeforeCatch)
                                    CurrentCompanion.show(2)
                                    If perversion > 85 && CurrentCompanion:perversion > 85 
                                        "The sex was MIND BLOWING! Afterwards we continued our date."
                                    Elseif perversion > 75 && CurrentCompanion:perversion > 75 
                                        "The sex was AWESOME! Afterwards we continued our date."
                                    Elseif perversion > 55 && CurrentCompanion:perversion > 55
                                        "The sex was amazing. Afterwards we continued our date."
                                    Elseif perversion > 45 && CurrentCompanion:perversion > 45
                                        "The sex was good. Afterwards we continued our date."
                                    Elseif CurrentCompanion:perversion < 35
                                        "The sex was nothing special ... afterwards we continued our date."
                                    Elseif CurrentCompanion:perversion < 10
                                        "The sex was awkward. Afterwards we continued our date."
                                    Else
                                        "The sex was ok. Afterwards we continued our date."
                                    Endif
                                    If CurrentCompanion:perversion == perversion
                                        "It seems that you both are a perfect fit when it comes to sex ..."
                                        CurrentCompanion:perversion += Random(0, 0.2)
                                        perversion += Random(0, 0.2)
                                    Elseif CurrentCompanion:perversion > perversion
                                        "You have the feeling that <CurrentCompanion.name> taught you something in bed ..."
                                        perversion += Random(0, 0.2)
                                    Elseif CurrentCompanion:perversion < perversion
                                        "You have the feeling that you could teach <CurrentCompanion.name> something in bed ..."
                                        CurrentCompanion:perversion += Random(0, 0.2)
                                    Endif
                                    If !CurrentCompanion.isProstitute() && CurrentCompanion.isDatingFriend() && XForcedTrigger > 0 && !OpenRelationship() && CurrentCompanion:masochist > -75
                                        "However, <Actor.name> immediately realized what <Actor.he_or_she> had done: breaking the first rule of friendship, and was overcome with guilt. <Actor.He_or_She> left in a hurry."
                                        Ongoing = false
                                    Endif
                                    passTime(0.2, 0.5)
                                Endif
                            Else
                                "Unfortunately for me, <CurrentCompanion.name> didn't seem interested in letting things escalate any further and pulled away."
                                If !CurrentCompanion.isProstitute() && CurrentCompanion.isDatingFriend() && XForcedTrigger > 0 && !OpenRelationship() && CurrentCompanion:masochist > -75
                                    Actor(Anxious):: "<Player.name>, you know we really shouldn't have done that. What if <Dating.name> finds out? Sorry ... I've got to go now."
                                    Ongoing = false
                                Endif
                            Endif
                        Else
                            CurrentCompanion.closeEyes(false)
                            Player.closeEyes(false)
                            "I decided to stop it there and not go any further."
                        Endif
                    
                    // GO HOME
                    Elseif Random(0, 100) < 15 && !UsedRapeDrug && !DebugLog
                        If CurrentCompanion.isDating()
                            "After a while, we were both exhausted and went to bed together for the night."
                            passTime(4, 8)
                            energy += Random(50, 100)
                            "The next morning ..."
                            If MyHome
                                CurrentCompanion(Happy):: "I've gotta go now, honey. Thanks for letting me stay the night. I can't wait to see you again soon!"
                            Else
                                Player(Happy):: "I've gotta go now, honey. Thanks for letting me stay the night. I can't wait to see you again soon!"
                            Endif
                            CurrentCompanion:attractiontoplayer += Random(0, 1)
                            Ongoing = false
                        Else  
                            If CurrentCompanion:masochist > 0 && [CurrentCompanion:arousal > 75 || CurrentCompanion:intoxication > 75 || CurrentCompanion:masochist > 65]
                                If CurrentCompanion.isRelative()
                                    "It seemed that my <CurrentCompanion.relationship> wanted to say something, but then <CurrentCompanion.he_or_she> stopped talking ... "
                                Else
                                    "It seemed that <CurrentCompanion.name> wanted to say something, but then <CurrentCompanion.he_or_she> stopped talking ... "
                                Endif
                            Elseif CurrentCompanion.isRelative() && CurrentCompanion.livesWithPlayer()
                                "After a while, we were both exhausted and both went to our rooms for the night."
                                CurrentCompanion:incest += Random(0, 1)
                                Ongoing = false
                            Else
                                If MyHome
                                    CurrentCompanion(Happy):: "I've gotta go now. Thank you for inviting me in."
                                    Player(Happy):: "Alright. Thank you for staying. Goodbye!"
                                Else
                                    CurrentCompanion(Happy):: "It has been a great day, but I'm getting quite tired now. Do you mind ..."
                                    "Getting the message from <CurrentCompanion.name>, I said goodbye."
                                Endif
                                If CurrentCompanion.isRelative()
                                    CurrentCompanion:incest += Random(0, 1)
                                Else
                                    CurrentCompanion:attractiontoplayer += Random(0, 1)
                                Endif
                                "We parted ways."
                                Ongoing = false
                            Endif
                        Endif
                    Endif
                Endif
            Endwhile
EndIf // patcher inserted
    Endif
    
    PCustomersToday = 0
    PMoneyToday = 0
    CustomersToday.clearGlobal()
    MoneyToday.clearGlobal()
    
    If !Ongoing
        HadAlreadySexBeforeCatch.clearGlobal()
        If CurrentCompanion.isProstitute()
            PCustomersToday = 0
            PMoneyToday = 0
            CustomersToday.clearGlobal()
            MoneyToday.clearGlobal()
        Endif
        endDate()
    Endif
    
    SceneEnd()

    